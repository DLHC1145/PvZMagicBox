<!DOCTYPE html>
<html lang="zh-CN">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
	<title>软件搜索下载</title>
	<style>
		:root {
			--nav-icon-size: 24px;
			--nav-text-size: 12px;
			--nav-height: 60px;
			--nav-icon-text-gap: 4px;
			--primary-color: #4CAF50;
			--text-secondary: #999;
		}
		* { margin: 0; padding: 0; box-sizing: border-box; }
		body {
			font-family: Arial, sans-serif;
			background-color: #f5f5f5;
			padding: 0;
			touch-action: pan-x pan-y;
			overflow-x: hidden;
			padding-bottom: var(--nav-height);
		}
		html {
			touch-action: manipulation;
			-webkit-text-size-adjust: none;
			-ms-text-size-adjust: none;
			text-size-adjust: none;
		}

		.search-section {
			background-color: white;
			padding: 8px 15px;
			border-bottom: none;
			position: relative;
		}
		.search-container {
			display: flex;
			align-items: center;
			background-color: white;
			border: 1px solid #ddd;
			border-radius: 25px;
			overflow: hidden;
			transition: all 0.3s ease;
			margin-left: -5px;
			width: calc(85% - 5px);
		}
		.search-container:focus-within {
			border-color: #2196F3;
		}
		.search-icon-area {
			width: 50px; height: 36px;
			background-image: url('搜索.png');
			background-size: cover;
			background-position: center;
			background-repeat: no-repeat;
			background-color: #f5f5f5;
			flex-shrink: 0;
			margin-right: 0;
		}
		.search-box {
			flex: 1;
			padding: 8px 16px;
			border: none;
			font-size: 15px;
			outline: none;
			background-color: #f5f5f5;
			min-width: 0;
			transition: background-color 0.3s;
		}
		.search-box::placeholder {
			color: #999; font-size: 14px;
		}
		.search-actions {
			display: flex;
			align-items: center;
			padding: 0 8px 0 0;
			margin-left: 8px;
		}
		.search-text {
			color: #666;
			font-size: 14px;
			cursor: pointer;
			padding: 4px 8px;
			border-radius: 4px;
			transition: background-color 0.2s;
			white-space: nowrap;
		}
		.search-text:hover {
			background-color: #f0f0f0;
			color: #333;
		}

		.history-btn {
			position: absolute;
			right: 15px; top: 50%;
			transform: translateY(-50%);
			width: 40px; height: 40px;
			background-image: url('历史记录.jpg');
			background-size: contain;
			background-position: center;
			background-repeat: no-repeat;
			background-color: transparent;
			border: none; cursor: pointer;
			padding: 0; transition: all 0.2s;
			border-radius: 6px;
		}
		.history-btn:hover {
			background-color: #f5f5f5;
			transform: translateY(-50%) scale(1.05);
		}
		.history-btn:active {
			transform: translateY(-50%) scale(0.95);
		}

		.cancel-btn {
			position: absolute;
			right: 15px; top: 50%;
			transform: translateY(-50%);
			background: none; border: none;
			color: #2196F3;
			font-size: 14px;
			padding: 6px 12px;
			cursor: pointer;
			transition: all 0.2s;
			font-weight: bold;
			white-space: nowrap;
		}
		.cancel-btn:hover {
			background-color: #f0f0f0;
			border-radius: 4px;
		}

		.search-result-page {
			position: fixed;
			top: 0; left: 0;
			width: 100%; height: 100%;
			background-color: white;
			z-index: 1000;
			display: none;
			flex-direction: column;
		}
		.search-result-page.active {
			display: flex;
		}
		.search-result-header {
			background-color: white;
			padding: 8px 15px;
			border-bottom: 1px solid #e5e5e5;
			display: flex;
			align-items: center;
			position: sticky;
			top: 0; z-index: 1001;
			width: 100%;
		}
		.search-result-input-wrapper {
			display: flex;
			align-items: center;
			background-color: white;
			border: 1px solid #ddd;
			border-radius: 25px;
			overflow: hidden;
			transition: all 0.3s ease;
			margin-left: -5px;
			width: calc(85% - 5px);
			flex-shrink: 0;
		}
		.search-result-input-wrapper:focus-within {
			border-color: #2196F3;
		}
		.search-result-icon-area {
			width: 50px; height: 36px;
			background-image: url('搜索.png');
			background-size: cover;
			background-position: center;
			background-repeat: no-repeat;
			background-color: #f5f5f5;
			flex-shrink: 0;
			margin-right: 0;
		}
		.search-result-input {
			flex: 1;
			padding: 8px 16px;
			border: none;
			font-size: 15px;
			outline: none;
			background-color: #f5f5f5;
			min-width: 0;
			transition: background-color 0.3s;
		}
		.search-result-input::placeholder {
			color: #999; font-size: 14px;
		}
		.search-result-actions {
			display: flex;
			align-items: center;
			padding: 0 8px 0 0;
			margin-left: 8px;
		}

		.software-list {
			padding: 0;
			flex: 1;
			overflow-y: auto;
			background-color: white;
		}
		.software-item {
			display: flex;
			align-items: center;
			padding: 15px;
			background-color: white;
			border-bottom: 1px solid #f0f0f0;
			transition: background-color 0.2s;
		}
		.software-item:hover {
			background-color: #f9f9f9;
		}
		.software-img {
			width: 50px; height: 50px;
			border-radius: 8px;
			margin-right: 15px;
			object-fit: cover;
		}
		.software-info {
			flex: 1;
			display: flex;
			flex-direction: column;
			min-width: 0;
		}
		.software-name {
			font-size: 16px;
			font-weight: bold;
			color: #333;
			margin-bottom: 5px;
			white-space: nowrap;
			overflow: hidden;
			text-overflow: ellipsis;
			max-width: 100%;
		}
		.software-score {
			color: #ff6b35;
			font-weight: bold;
			font-size: 14px;
		}
		.download-btn-main {
			padding: 8px 16px;
			background-color: #2196F3;
			color: white;
			border: none;
			border-radius: 15px;
			cursor: pointer;
			font-size: 14px;
			transition: background-color 0.3s;
			text-decoration: none;
			display: inline-block;
			text-align: center;
		}
		.download-btn-main:hover {
			background-color: #1976D2;
		}
		.download-btn-main[disabled] {
			background-color: #ccc;
			cursor: not-allowed;
		}
		.no-results {
			text-align: center;
			padding: 40px;
			color: #666;
			font-size: 16px;
			background-color: white;
		}

		.history-page {
			position: fixed;
			top: 0; left: 0;
			width: 100%; height: 100%;
			background-color: #f5f5f5;
			z-index: 1000;
			display: none;
			overflow-y: auto;
		}
		.history-page.active {
			display: block;
		}
		.history-header {
			background-color: white;
			padding: 8px 15px;
			border-bottom: 1px solid #e5e5e5;
			display: flex;
			align-items: center;
			position: sticky;
			top: 0; z-index: 1001;
		}
		.back-btn {
			background: none; border: none;
			font-size: 18px;
			color: #2196F3;
			margin-right: 15px;
			cursor: pointer;
			padding: 5px;
			border-radius: 50%;
			width: 35px; height: 35px;
			display: flex;
			align-items: center;
			justify-content: center;
		}
		.back-btn:hover {
			background-color: #f0f0f0;
		}
		.history-title {
			font-size: 16px;
			font-weight: bold;
			color: #333;
			flex: 1;
		}
		.history-content {
			padding: 15px;
		}
		.history-search-item {
			background-color: white;
			margin-bottom: 15px;
			border-radius: 8px;
			overflow: hidden;
			box-shadow: 0 2px 8px rgba(0,0,0,0.1);
		}
		.history-search-header {
			background-color: #f8f9fa;
			padding: 12px 15px;
			display: flex;
			justify-content: space-between;
			align-items: center;
			border-bottom: 1px solid #e5e5e5;
		}
		.history-search-keyword {
			font-size: 14px;
			color: #666;
			flex: 1;
		}
		.history-search-keyword strong {
			color: #333;
		}
		.history-search-btn {
			background-color: #81C784;
			color: white;
			border: none;
			border-radius: 15px;
			padding: 6px 12px;
			font-size: 12px;
			cursor: pointer;
			display: flex;
			align-items: center;
			gap: 4px;
			transition: background-color 0.3s;
		}
		.history-search-btn:hover {
			background-color: #66BB6A;
		}
		.history-search-results {
			padding: 0;
		}
		.history-result-item {
			display: flex;
			align-items: center;
			padding: 12px 15px;
			border-bottom: 1px solid #f0f0f0;
			transition: background-color 0.2s;
		}
		.history-result-item:last-child {
			border-bottom: none;
		}
		.history-result-item:hover {
			background-color: #f9f9f9;
		}
		.history-result-img {
			width: 40px; height: 40px;
			border-radius: 6px;
			margin-right: 12px;
			object-fit: cover;
		}
		.history-result-info {
			flex: 1;
			display: flex;
			flex-direction: column;
		}
		.history-result-name {
			font-size: 14px;
			font-weight: bold;
			color: #333;
			margin-bottom: 3px;
		}
		.history-result-score {
			font-size: 12px;
			color: #ff6b35;
			font-weight: bold;
		}
		.empty-history {
			text-align: center;
			padding: 60px 20px;
			color: #999;
			font-size: 14px;
		}

		/* 应用详情页背景改为浅蓝白色 */
		#fullscreenModal {
			background-color: #f0f7ff;
		}
		#fullscreenModal .fullscreen-modal-content {
			background-color: #f0f7ff;
		}
		#fullscreenModal .fullscreen-modal-header {
			background-color: #e6f2ff;
			border-bottom: 1px solid #cce0ff;
		}
		#fullscreenModal .fullscreen-modal-title {
			color: #1a365d;
		}
		#fullscreenModal .fullscreen-score {
			color: #2c5282;
		}
		#fullscreenModal .fullscreen-desc {
			color: #4a5568;
		}
		#fullscreenModal .fullscreen-download-title {
			color: #2d3748;
		}

		/* 游戏展示区域背景改为淡蓝色 */
		#imageShowcase {
			background-color: #e6f3ff;
			border: 1px solid #cce7ff;
		}
		#imageShowcase .image-showcase-title {
			color: #1a365d;
		}

		/* 下载按钮改为胶囊形 */
		#fullscreenDownloadOptions .fullscreen-download-option {
			border-radius: 25px;
		}
		/* 下载按钮高亮蓝色 */
		#fullscreenDownloadOptions .fullscreen-download-option {
			background: #4285F4;
		}
		#fullscreenDownloadOptions .fullscreen-download-option:hover {
			background: #5A9FFF;
		}

		/* popup正文圆框容器 */
		.fullscreen-desc-container {
			background-color: white;
			border: 2px solid #cce0ff;
			border-radius: 12px;
			padding: 20px;
			margin: 15px 0 25px 0;
			box-shadow: 0 4px 12px rgba(33, 150, 243, 0.1);
			position: relative;
		}
		.fullscreen-desc-container::before {
			content: '';
			position: absolute;
			top: -2px; left: -2px; right: -2px; bottom: -2px;
			background: linear-gradient(135deg, #2196F3, #64B5F6);
			border-radius: 12px;
			z-index: -1;
			opacity: 0.3;
		}
		.fullscreen-desc-container .fullscreen-desc {
			margin: 0; padding: 0;
			background-color: transparent;
			color: #2d3748;
			line-height: 1.7;
			font-size: 15px;
		}

		/* 下载按钮尺寸调整 */
		#fullscreenDownloadOptions .fullscreen-download-option {
			min-width: 102%;
			width: 102%;
			padding: 17px 21px;
			margin: 0 auto;
			display: block;
			font-size: 15px;
			padding-top: 18px;
			padding-bottom: 18px;
		}
		#fullscreenDownloadOptions {
			padding: 0 5%;
		}
		#fullscreenDownloadTitle {
			margin: 25px 15px 25px 15px;
		}
		.fullscreen-modal-content {
			padding-bottom: 30px;
		}

		/* 模态框基础样式 */
		.fullscreen-modal-overlay {
			position: fixed;
			top: 0; left: 0;
			width: 100%; height: 100%;
			z-index: 3000;
			display: none;
			flex-direction: column;
			overflow: hidden;
		}
		.fullscreen-modal-overlay.active {
			display: flex;
		}
		.fullscreen-modal-header {
			padding: 15px;
			border-bottom: 1px solid #e5e5e5;
			display: flex;
			align-items: center;
			position: sticky;
			top: 0;
			z-index: 3001;
			box-shadow: 0 2px 8px rgba(0,0,0,0.1);
		}
		/* 标题栏左侧图标 */
		.fullscreen-modal-icon {
			width: 32px;
			height: 32px;
			border-radius: 6px;
			object-fit: cover;
			margin-right: 12px;
			vertical-align: middle;
			background-color: #eee;
		}
		.fullscreen-modal-title {
			font-size: 20px;
			font-weight: 900;
			flex: 1;
			line-height: 1.4;
			display: flex;
			align-items: center;
		}
		.fullscreen-modal-close {
			background: none;
			border: none;
			font-size: 24px;
			color: #999;
			cursor: pointer;
			width: 40px;
			height: 40px;
			display: flex;
			align-items: center;
			justify-content: center;
			border-radius: 50%;
			transition: all 0.2s;
			margin-right: 15px;
			flex-shrink: 0;
		}
		.fullscreen-modal-close:hover {
			background-color: #f5f5f5;
			color: #333;
		}
		.fullscreen-modal-content {
			flex: 1;
			overflow-y: auto;
			padding: 20px;
		}
		.fullscreen-score {
			font-size: 14px;
			font-weight: 900;
			margin: 0 15px 10px 15px;
			text-align: center;
		}
		.image-showcase {
			margin: 10px 0 15px 0;
			border-radius: 12px;
			padding: 0;
			box-shadow: 0 2px 8px rgba(0,0,0,0.1);
			overflow: hidden;
		}
		.image-showcase-title {
			font-size: 16px;
			font-weight: bold;
			margin: 15px 0 10px 15px;
			text-align: center;
		}
		.image-slider-container {
			position: relative;
			width: 100%;
			overflow: hidden;
			background-color: #000;
		}
		.image-slider {
			display: flex;
			transition: transform 0.3s ease;
			gap: 0;
		}
		.slider-image {
			flex-shrink: 0;
			width: 100%;
			height: auto;
			max-height: 70vh;
			object-fit: contain;
			border-radius: 0;
			background-color: #000;
			display: block
		}
		.slider-nav {
			display: flex;
			justify-content: flex-end;
			align-items: center;
			margin: 15px 148px 6px 0;
			gap: 8px;
		}
		.slider-dot {
			width: 8px;
			height: 8px;
			border-radius: 50%;
			background-color: #ddd;
			cursor: pointer;
			transition: all 0.2s;
		}
		.slider-dot.active {
			background-color: #2196F3;
			transform: scale(1.2);
		}
		.fullscreen-desc {
			font-size: 14px;
			line-height: 1.6;
			margin: 15px 0 25px 0;
			padding: 0 5px;
			text-align: justify;
		}
		.fullscreen-divider {
			margin: 10px 0;
		}
		.fullscreen-download-title {
			font-size: 16px;
			font-weight: bold;
			margin: 20px 15px 20px 15px;
			text-align: center;
		}
		.fullscreen-download-options {
			display: flex;
			flex-direction: column;
			gap: 12px;
			padding: 0 15px;
		}
		.fullscreen-download-option {
			padding: 15px 20px;
			background: linear-gradient(135deg, #2196F3, #1976D2);
			color: white;
			border: none;
			font-size: 15px;
			cursor: pointer;
			transition: all 0.2s;
			text-align: center;
			display: flex;
			align-items: center;
			justify-content: center;
			box-shadow: 0 4px 12px rgba(33, 150, 243, 0.3);
			position: relative;
			overflow: hidden;
		}
		.fullscreen-download-option::before {
			content: '';
			position: absolute;
			top: 0;
			left: -100%;
			width: 100%;
			height: 100%;
			background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
			transition: left 0.5s;
		}
		.fullscreen-download-option:hover::before {
			left: 100%;
		}

		.bottom-nav {
			position: fixed;
			bottom: 0; left: 0;
			width: 100%;
			height: var(--nav-height);
			background-color: #fff;
			border-top: 1px solid #e5e5e5;
			display: flex;
			justify-content: space-around;
			align-items: center;
			z-index: 200;
			box-shadow: 0 -2px 10px rgba(0,0,0,0.1);
		}
		.nav-item {
			display: flex;
			flex-direction: column;
			align-items: center;
			justify-content: center;
			flex: 1;
			height: 100%;
			text-decoration: none;
			color: var(--text-secondary);
			transition: color 0.3s;
			position: relative;
		}
		.nav-item.active {
			color: var(--primary-color);
		}
		.nav-item:hover {
			color: var(--primary-color);
		}
		.nav-icon-img {
			width: var(--nav-icon-size);
			height: var(--nav-icon-size);
			object-fit: contain;
			margin-bottom: var(--nav-icon-text-gap);
		}
		.nav-text {
			font-size: var(--nav-text-size);
			font-weight: normal;
			line-height: 1;
			height: auto;
		}
	</style>
</head>
<body>
	<div class="search-section">
		<div class="search-container">
			<div class="search-icon-area"></div>
			<input type="text" id="searchInput" class="search-box" placeholder="搜索软件名称">
			<div class="search-actions">
				<span id="searchText" class="search-text">搜索</span>
			</div>
		</div>
		<button id="historyBtn" class="history-btn"></button>
		<button id="cancelBtn" class="cancel-btn" style="display: none;">取消</button>
	</div>

	<div id="softwareList" class="software-list"></div>

	<div id="searchResultPage" class="search-result-page">
		<div class="search-result-header">
			<div class="search-result-input-wrapper">
				<div class="search-result-icon-area"></div>
				<input type="text" id="searchResultInput" class="search-result-input" placeholder="搜索软件名称">
				<div class="search-result-actions">
					<span class="search-text">搜索</span>
				</div>
			</div>
			<button id="resultCancelBtn" class="cancel-btn">取消</button>
		</div>
		<div id="resultSoftwareList" class="software-list"></div>
	</div>

	<div id="historyPage" class="history-page">
		<div class="history-header">
			<button id="backBtn" class="back-btn">←</button>
			<div class="history-title">历史记录</div>
		</div>
		<div id="historyContent" class="history-content"></div>
	</div>

	<!-- 应用详情弹窗 -->
	<div id="fullscreenModal" class="fullscreen-modal-overlay">
		<div class="fullscreen-modal-header">
			<button id="fullscreenModalClose" class="fullscreen-modal-close">×</button>
			<div id="fullscreenModalTitle" class="fullscreen-modal-title">
				<img id="fullscreenModalIcon" class="fullscreen-modal-icon" src="" alt="icon">
				<span id="fullscreenModalTitleText"></span>
			</div>
		</div>
		<div class="fullscreen-modal-content">
			<div id="fullscreenScore" class="fullscreen-score"></div>
			<div id="imageShowcase" class="image-showcase" style="display: none;">
				<div class="image-showcase-title">游戏展示</div>
				<div class="image-slider-container">
					<div id="imageSlider" class="image-slider"></div>
				</div>
				<div id="sliderNav" class="slider-nav"></div>
			</div>
			<div id="fullscreenDescWrapper" class="fullscreen-desc-container">
				<div id="fullscreenDesc" class="fullscreen-desc"></div>
			</div>
			<div class="fullscreen-divider"></div>
			<div id="fullscreenDownloadTitle" class="fullscreen-download-title">请选择下载方式：</div>
			<div id="fullscreenDownloadOptions" class="fullscreen-download-options"></div>
		</div>
	</div>

	<div class="bottom-nav" id="bottomNav"></div>

	<script>
		// ========== 多语言核心功能 ==========
		let isEnglishMode = false;
		function saveLanguageState(isEnglish) {
			localStorage.setItem('isEnglish', isEnglish.toString());
		}
		function getLanguageState() {
			return localStorage.getItem('isEnglish') === 'true';
		}
		function detectBrowserLanguage() {
			const lang = navigator.language || navigator.userLanguage;
			return lang.startsWith('en') || lang.startsWith('EN');
		}
		function translateText(text, targetLang = 'en') {
			if (targetLang === 'en' && /^[a-zA-Z\s]+$/.test(text.trim())) {
				return text;
			}
			const translations = {
				"搜索软件名称": "Search software name",
				"搜索": "Search",
				"取消": "Cancel",
				"历史记录": "History",
				"没有找到相关软件": "No software found",
				"下载": "Download",
				"暂无下载": "No download",
				"请选择下载方式：": "Please choose download method:",
				"暂无搜索历史": "No search history",
				"所有软件已在上方显示完毕": "All software displayed above",
				"搜索：": "Search:",
				"主页": "Home",
				"论坛": "forum",
				"我的": "Profile",
				"植物大战僵尸2官方版": "Plants vs. Zombies 2 Official Version",
				"植物大战僵尸2时空再旅1.0.4": "Plants vs. Zombies 2 Time Travel 1.0.4",
				"植物大战僵尸2Ark版": "Plants vs. Zombies 2 Ark Version",
				"植物大战僵尸2衍生版": "Plants vs. Zombies 2 Derivative Version",
				"植物大战僵尸2国际版（汉化+恢复拓展+恢复音乐）": "Plants vs. Zombies 2 International Version (Chinese + Expansion + Music)",
				"植物大战僵尸2返茂版（PvZ 2: Reflourished）": "Plants vs. Zombies 2 Reflourished",
				"Team Sparks Il PvZ2 Modders（需要魔法）": "Team Sparks Il PvZ2 Modders (Need VPN)",
				"植物大战僵尸2：迷宫回响": "Plants vs. Zombies 2: Maze Echo",
				"植物大战僵尸2：迷宫拓展版": "Plants vs. Zombies 2: Maze Expansion",
				"小马宝莉大战僵尸5": "My Little Pony vs Zombies 5",
				"植物大战僵尸2天空之城内购破解": "Plants vs. Zombies 2 Sky City Cracked",
				"植物大战僵尸无尽版内购破解": "Plants vs. Zombies Endless Edition Cracked",
				"植物大战僵尸全明星qwq版": "Plants vs. Zombies All Stars qwq Version",
				"Plants vs Zombies：Brave New World": "Plants vs Zombies：Brave New World",
				"植物大战僵尸：乐Pad版": "Plants vs. Zombies: LePad Version",
				"8.7分  原汁原味的中文官方版本": "8.7/10 - Authentic Chinese official version",
				"8.8分  作者：想不出名字、Mz工作室": "8.8/10 - Author: Can't think of a name, Mz Studio",
				"8.7分  作者：今霄是飘逸的利己主义者": "8.7/10 - Author: Tonight is an elegant egoist",
				"7.8分  作者：小米食堂厨师长": "7.8/10 - Author: Fan of Northeast Yujie",
				"9.0分  作者：特别的伊将军 版本12.7.1": "9.0/10 - Author: Special General Yi, Version 12.7.1",
				"8.9分  总作者：PvZABFan＆PeaMix": "8.9/10 - Authors: PvZABFan & PeaMix",
				"8分 一个由画师和模组作者组成的团队，致力于创建、动画和编写素材，供模组社区免费使用!": "8/10 - A team of artists and modders creating animations and materials for free use!",
				"7.9分  一款不错的迷宫改版，内含丰富的游戏内容！": "7.9/10 - A good maze modification with rich content!",
				"8.1分  完成度很的迷宫改版，拥有妙趣横生的游戏体验！": "8.1/10 - High-quality maze modification with fun gameplay!",
				"8.6分  小马宝莉大战僵尸的第五部，小马大战僵尸收官之作！": "8.6/10 - My Little Pony vs Zombies 5, the final installment!",
				"7.9分  经典迷宫版v1.6.1内购破解版！无须花钱即可获取资源 此版本纯琨曲！": "7.9/10 - Classic maze v1.6.1 cracked version! Get resources for free!",
				"7.7分  经典一代官方版本内购破解，包含西游、龙宫、长城三大内容！": "7.7/10 - Classic version 1 cracked with Journey to the West content!",
				"8.5分  经典全明星版本的改版！内涵丰富内容和无与伦比的新奇体验": "8.5/10 - Classic All Stars modification with rich content!",
				"8.8分  目前仅支持电脑端游玩，加入群聊在群文件中下载游戏包": "8.8/10 - PC only, join group to download game package",
				"6.8分 在一众一代版本中，此版本十分高清！对高版本系统的适配也是一流的。": "6.8/10 - High definition version with excellent system compatibility!",
				"加入官方代理社区！": "Join official community!",
				"加入QQ5群": "Join QQ Group 5",
				"加入QQ3群": "Join QQ Group 3",
				"加入QQ2群": "Join QQ Group 2",
				"加入QQ4群": "Join QQ Group 4",
				"加入Discord！（需要您会魔法）": "Join Discord! (Need VPN)",
				"加入官方Discord社区！": "Join official Discord community!",
				"加入Discord": "Join Discord",
				"加入官方群！在群内获取游戏资源": "Join official group! Get game resources in group",
				"加入QQ交流群获取": "Join QQ group to get",
				"加入官方QQ群！下载最新游戏资源": "Join official QQ group! Download latest game resources",
				"查看群简介，加入拓展QQ官方群": "Check group intro, join expansion QQ group",
				"使用onedrive在线下载（需要魔法）": "Download via onedrive (Need VPN)",
				"经多年守卫控住僵尸，但小马谷已成废墟。星光熠熠决定穿越到第一天剿灭僵尸，重启时空扭转残局！": "After years of defending, Ponyville is in ruins. Starlight Glimmer travels back to day one to save the day!",
				"加入QQ官方群获取": "Join QQ official group to get",
				"在线123云盘下载": "Download via 123 cloud drive",
				"123云盘下载": "Download via 123 cloud drive",
				"该版本较为远古，内购破解会闪退，但可正常到账。高系统手机启动时小概率闪退，但第三次必定进入。": "Older version, cracked features may crash but work. High system phones may crash but work on third try.",
				"云盘下载": "Cloud drive download",
				"版本相对于原版没有花园、解谜元素，但是在关卡中会出现灌木丛。而对比移动端的其他版本，这个版本的特点在于支持1280x800分辨率画面。且对于PAD的适配更好！": "No garden/puzzle elements, but has bushes. Supports 1280x800 resolution, better for PAD!",
				"《植物大战僵尸：美丽新世界》重拾系列经典玩法。开放更多的自定义插件项目，带来无与伦比的体验。玩家将再度开启跨时空冒险，收集并运用植物，全力抵御僵尸浪潮的入侵，重温原味塔防体验。": "\"Plants vs. Zombies: Brave New World\" revives classic gameplay with more customization. Players adventure through time to defend against zombies!",
				"点击加群获取": "Click to join group to get",
				"获取": "Get",
				"在线使用云盘下载（直装包）": "Online cloud disk download (direct package)",
				"西部的某座鬼镇，海湾边的海盗们，埃及的法老王... 传奇的迷宫却不知为何消逝的无影无踪。 总在回忆着，某座小镇、某支钥匙、某个机器所说的大脑的断裂。 低画质与阉割的小曲却包含着老玩家的回忆，这是回不去的..吗? 改版《植物大战僵尸2:迷宫·混沌》欢迎您来体验！": "A ghost town in the West, pirates by the bay, Egyptian pharaohs... The legendary maze vanished without a trace for unknown reasons. Always recalling: a small town, a key, a machine's mention of the brain's fracture. Low-res graphics and cut-down tunes hold old players' memories—gone forever... or not? Modified Plants vs. Zombies 2: Maze·Chaos welcomes you to experience!",
				"下载必要文件（针对部分设备）": "Download necessary files (for some devices)",
				"前往QQ群获取最新版本，第一时间获取最新版本更新！使用123云盘下载，直接在线下载！":"Join the QQ group to get the latest versionand receive updates as soon as they're released!Download via 123 Cloud Disk for direct online downloading!",
				"前往": "Go",
				"8.4分  作者：玉米 在《植物大战僵尸：迷宫·混沌》中，过往的传奇不再是想象与回忆。": "8.4/10-Corn In Plants vs. Zombies: Maze and Chaos, the legend of the past is no longer imagination and memory.",
				"植物大战僵尸2迷宫混沌版": "Plants vs. Zombies 2 Maze: Chaos",
				"8.2分  内含内购破解、画质高清修复！作者：玉米，7000i，屑fell":"8.2/10Classic Maze Version 1.7.5 - The Final Maze Edition! Authors: Corn, 7000i, Sai fell",
				"1.7.5经典迷宫版本！内含内购破解、画质高清修复！是最后一个迷宫版本！":"Version 1.7.5 - Classic Maze Edition! Includes in-app purchase crack and high-definition graphics restoration! This is the final maze version!",
				"植物大战僵尸2失落之城1.7.5":"Plants vs. Zombies 2: Lost City 1.7.5",
				"植物大战僵尸2国际版：DLC":"Plants vs. Zombies 2:DLC.mods",
				"9.1分  作者：Daybs PVZ2: DLC系列致力于带来再续国际版主线的独特体验。 如“泳池派对”“罗马帝国”！版本25.1.0":"9.1/10 — Author: Daybs — PVZ2 DLC:mods —A series of original custom levels continuing the mainline, featuring Pool Party and Roman Empire. Version 25.1.0.",
				"PVZ2: DLC原版自制关卡系列由Daybs独立制作，致力于带给玩家再续国际版主线的独特体验。拥有经过精心设计的如“泳池派对”“罗马帝国”的主线世界！":"An  DLC level series by Daybs,  picking up after the international main story,  with main worlds like Pool Party and Roman Empire."
			};
			return translations[text] || text;
		}
		function checkLanguageState() {
			const saved = getLanguageState();
			isEnglishMode = saved === null ? detectBrowserLanguage() : saved;
		}
		function getTranslatedSoftwareData() {
			if (!isEnglishMode) return originalSoftwareData;
			const translated = JSON.parse(JSON.stringify(originalSoftwareData));
			translated.forEach(item => {
				item.name = translateText(item.name);
				item.score = translateText(item.score);
				if (item.downloadText) item.downloadText = translateText(item.downloadText);
				if (item.popup) {
					item.popup.text = translateText(item.popup.text);
					if (item.popup.downloads) {
						item.popup.downloads.forEach(d => {
							if (d.text) d.text = translateText(d.text);
						});
					}
				}
			});
			return translated;
		}

		// ========== 底部导航渲染 ==========
		const NAV_CONFIG = [
			{ icon: 'home.png', text: { zh: '主页', en: 'Home' }, link: 'index.html', active: true },
			{ icon: 'author.png', text: { zh: '发现', en: 'Discover' }, link: 'index2.html' },
			{ icon: 'my.png', text: { zh: '我的', en: 'Profile' }, link: 'index3.html' }
		];

		function renderBottomNav() {
			const nav = document.getElementById('bottomNav');
			if (!nav) return;
			nav.innerHTML = NAV_CONFIG.map(item => {
				const text = isEnglishMode ? item.text.en : item.text.zh;
				const activeClass = item.active ? 'active' : '';
				return `<a href="${item.link}" class="nav-item ${activeClass}" data-page="${text}"><img src="${item.icon}" class="nav-icon-img" alt="${text}"><div class="nav-text">${text}</div></a>`;
			}).join('');
			nav.querySelectorAll('.nav-item').forEach(el => {
				el.addEventListener('click', function(e) {
					const curr = location.pathname.split('/').pop() || 'index.html';
					const targetText = this.dataset.page;
					const pageMap = {};
					NAV_CONFIG.forEach(n => {
						const textKey = isEnglishMode ? 'en' : 'zh';
						pageMap[n.text[textKey]] = n.link.split('/').pop();
					});
					if (curr === pageMap[targetText]) {
						e.preventDefault();
						return false;
					}
					nav.querySelectorAll('.nav-item').forEach(i => i.classList.remove('active'));
					this.classList.add('active');
				});
			});
			const current = location.pathname.split('/').pop() || 'index.html';
			nav.querySelectorAll('.nav-item').forEach(el => {
				const targetText = el.dataset.page;
				const pageMap = {};
				NAV_CONFIG.forEach(n => {
					const textKey = isEnglishMode ? 'en' : 'zh';
					pageMap[n.text[textKey]] = n.link.split('/').pop();
				});
				el.classList.toggle('active', current === pageMap[targetText]);
			});
		}

const originalSoftwareData = [
			{
				rank: 1,
				name: "植物大战僵尸2官方版",
				score: "8.7分  原汁原味的中文官方版本",
				downloadUrl: "https://pvz2apk-cdn.ditwan.cn/1730/baokai_3.9.0_1730_381_dj2.0-3.0.0.apk",
				image: "植物大战僵尸2.jpg"
			},
			{
				rank: 1,
				name: "植物大战僵尸2时空再旅1.0.4",
				score: "8.8分  作者：想不出名字、Mz工作室",
				downloadUrl: "时空再旅.html",
				image: "植物大战僵尸2时空再旅.jpg",
				popup: {
					text: "前往QQ群获取最新版本，第一时间获取最新版本更新！使用123云盘下载，直接在线下载！",
					downloads: [
						{
							url: "https://qun.qq.com/universal-share/share?ac=1&authKey=pMvpgZU0YPz7bZCqelq7X1Mr8tY16MbElo0AVgeyirj8d%2BIMxxPkir4znIuzKpDw&busi_data=eyJncm91cENvZGUiOiI2MTU4ODQyMzAiLCJ0b2tlbiI6IjZnVGY1MTdrTzEwSTdIR2tIYUR2eFhRN2NGeEN1NXV5YXNwMGhwWm1neDJaV3JPZXZteTNDbm1mWWFhNE9xa28iLCJ1aW4iOiIyMDE5OTQ3MDg1In0%3D&data=Jqwb4iWeIUYCZWtT7RbO0BNx8su2riRaiXx1Aj7sLpM1T81ggFQ7fwBwn-X8ZODiX9YxVfk0wmeP3-wjvPCfEA&svctype=4&tempid=h5_group_info",
							text: "加入QQ交流群获取"
						},
						{
							url: "https://www.123684.com/s/zWgIjv-xzA8",
							text: "在线123云盘下载"
						}
					]
				}
			},
			{
				rank: 1,
				name: "植物大战僵尸2Ark版",
				score: "8.7分  作者：今霄是飘逸的利己主义者",
				downloadUrl: "https://www.123684.com/s/zWgIjv-XcA8",
				image: "植物大战僵尸2ark.jpg",
					popup: {
					text: "游戏定位是剧情为主，难度休闲偏微挑战！",
					downloads: [
						{
							url: "",
							text: "QQ:1005196747"
						},
						{
							url: "https://www.123684.com/s/zWgIjv-XcA8",
							text: "在线使用云盘下载"
						}
					]
				}
			},
			{
				rank: 1,
				name: "植物大战僵尸2迷宫混沌版",
				score: "8.4分  作者：玉米 在《植物大战僵尸：迷宫·混沌》中，过往的传奇不再是想象与回忆。",
				downloadUrl: "https://www.123684.com/s/zWgIjv-XcA8",
				image: "植物大战僵尸2混沌.jpg",
					popup: {
					text: "西部的某座鬼镇，海湾边的海盗们，埃及的法老王... 传奇的迷宫却不知为何消逝的无影无踪。 总在回忆着，某座小镇、某支钥匙、某个机器所说的大脑的断裂。 低画质与阉割的小曲却包含着老玩家的回忆，这是回不去的..吗? 改版《植物大战僵尸2:迷宫·混沌》欢迎您来体验！",
					downloads: [
						{
							url: "https://www.123684.com/s/zWgIjv-o5A8",
							text: "在线使用云盘下载（直装包）"
						},
						{
							url: "https://www.123684.com/s/zWgIjv-45A8",
							text: "下载必要文件（针对部分设备）"
						},
						{
							url: "https://qun.qq.com/universal-share/share?ac=1&authKey=Okd%2FuENO%2BfyYysJiR2N8HZby1U7AqM8skUgUaSI3GzCGL9KfJYpdPy4GQXXEXI62&busi_data=eyJncm91cENvZGUiOiIzMTQwOTE2NzMiLCJ0b2tlbiI6IjRaSEVMems3ZWlPRDV3RWxzR0lUNmsybEpxT0hvcldIVkczTGUxd1crcGlMOXlNZCtBZkxQYjdIRWo3aVdPTDYiLCJ1aW4iOiIyMDE5OTQ3MDg1In0%3D&data=pbcT5R33MPQ-fj_QqCISbXIxTvbwNpfuzTLZvg9GbrSR1K1pe3nYwE_rduikQeYdJFTyJYSmoB38ZR60kFsrbg&svctype=4&tempid=h5_group_info",
							text: "加入QQ交流群获取"
						}
					]
				}
			},
			{
				rank: 1,
				name: "植物大战僵尸2衍生版",
				score: "7.8分  作者：小米食堂厨师长",
				downloadUrl: "https://www.123684.com/s/zWgIjv-ncA8",
				image: "植物大战僵尸2衍生.jpg"
			},
			{
				rank: 1,
				name: "植物大战僵尸2国际版（汉化+恢复拓展+恢复音乐）",
				score: "9.0分  作者：特别的伊将军 版本12.7.1",
				downloadUrl: "http://www.123865.com/s/Xpv9-ndDxh",
				image: "植物大战僵尸2国际版汉化.jpg"
			},
			{
				rank: 1,
				name: "植物大战僵尸2国际版：DLC",
				score: "9.1分  作者：Daybs PVZ2: DLC系列致力于带来再续国际版主线的独特体验。 如“泳池派对”“罗马帝国”！版本25.1.0",
				downloadUrl: "http://www.123865.com/s/Xpv9-ndDxh",
				image: "植物大战僵尸2DLC.jpg",
				textpng: ["应用快照：dlc1.jpg"],
				popup: {
					text: "PVZ2: DLC原版自制关卡系列由Daybs独立制作，致力于带给玩家再续国际版主线的独特体验。拥有经过精心设计的如“泳池派对”“罗马帝国”的主线世界！",
					downloads: [
						{ url: "https://qun.qq.com/universal-share/share?ac=1&authKey=RnWhP%2BiImfcUj62qfVCB6tmL%2BdjlKkqP%2B6kaXQzKWbb2%2FI3oqmmYpdriQMFt3Kv8&busi_data=eyJncm91cENvZGUiOiI3MTQyNjExMTkiLCJ0b2tlbiI6IjZ0UjUzZG5Da3ZRWXpIdyszajdxSFovV241VkxWTHpkNUNyUERhcWd1QjJEVTNuc0xvUHI1UHY4am90SUd4Z0UiLCJ1aW4iOiIyMDE5OTQ3MDg1In0%3D&data=214zvOX6zKMzpEQ3GP0s_yhE4edwjKHN3fYwDTQsAKbWszB7qPHyBN_L96AYQjK5TWK88hU3uZhvF03s2HnrcA&svctype=4&tempid=h5_group_info", text: "加入QQ交流群获取" }
					]
				}
			},
			{
				rank: 1,
				name: "植物大战僵尸2返茂版（PvZ 2: Reflourished）",
				score: "8.9分  总作者：PvZABFan＆PeaMix",
				downloadUrl: "",
				image: "植物大战僵尸2返茂.jpg",
				downloadText: "获取",
				popup: {
					text: "加入官方代理社区！",
					downloads: [
						{ url: "https://qun.qq.com/universal-share/share?ac=1&authKey=Q%2B0UlGy20lQ3QZK0EerwxmGB1bAObqvRIf2bS3er9hre5FlCc1QqmsMteMM28Ict&busi_data=eyJncm91cENvZGUiOiI3Mjg5MTI1OTAiLCJ0b2tlbiI6InJIZnRKeDBRTzA2RytIOHhLRkJGMVFVb2dNODJrU2U4Vmxjc01aeWNsQkZ5bTdEVThJZytsRmhkVEdYNDNrcDciLCJ1aW4iOiIzNjQyNzk4NTAxIn0=&data=g0g3S977SBHDZA3bmqCEcm8N0-Xqpkj1OaEXnbAIQLpkR-k6YJ5klqoAHnSPPuqRuBZ-iw4DRs1VUp7RWF5z08gEiPig6LaFxd-CV2lMdvs&svctype=5&tempid=h5_group_info", text: "加入QQ5群" },
						{ url: "https://qun.qq.com/universal-share/share?ac=1&authKey=NmdtopylzCH3nLWwJA2wk9H254Wokda/gPlatCmvddF%2Bp9S2jo5s5E8IraQLanpl&busi_data=eyJncm91cENvZGUiOiI5MzExMTA5ODIiLCJ0b2tlbiI6Ik40TEQzQmJycDNYVVVwRHMzSVlQRlBCWm9oamJUS01UME1GdTV1VlJjcUlkVlVER3Vwb2xiQ204dVVwK0txWVkiLCJ1aW4iOiIzNjQyNzk4NTAxIn0=&data=VkL34vGAhrxyF1eRUjQOMyHE5GHPE4Xv_OP-7LtaOV5r1Vk3ikzaik78ZgjMj9SOc7jbVctCKgQXNYiJQopv1M7gu_C8DlU9UgDsMwNhysw&svctype=5&tempid=h5_group_info", text: "加入QQ3群" },
						{ url: "https://qun.qq.com/universal-share/share?ac=1&authKey=lzXZ6HoGY45kdTvb0Nor65sGZMp/CmymA%2BvID75AFF9elpR4H7MTeJkQMWi%2BI2St&busi_data=eyJncm91cENvZGUiOiI2NjA5NTg5MzciLCJ0b2tlbiI6ImJwOUg0QWFmL2l0RE9LUFpLcENmbkRoT2UzNUFDUVgvS3dBb1R5eVlQbHhjSmorbktCdkxDdXRJandMcEorclAiLCJ1aW4iOiIzNjQyNzk4NTAxIn0=&data=w31o7ZlGSKFgFFZnxlQLXJpwbTWgofOkOFHoiNghDKGwhqtZ5RUbHwVXgUET4W8OIq-uTTJ9Q2mgeUucwH2mtB9pXh1dODJZqRwK4jqiVPQ&svctype=5&tempid=h5_group_info", text: "加入QQ2群" },
						{ url: "https://qun.qq.com/universal-share/share?ac=1&authKey=ikzndDW%2BIZ9sDmXioQS6wUD9n5ZOhtpfFtCCeB0Xg5eAIu4UYotsz1wcWVZSfHZt&busi_data=eyJncm91cENvZGUiOiI2OTY5ODI0OTUiLCJ0b2tlbiI6Im5UVDIraURyYnI5cW9ibjBZZVZvdVpzbE1hQkpkaWF3QThoRkFWRXBVNm1lSUhxelRmZExyemdKdnloV3lkSFoiLCJ1aW4iOiIzNjQyNzk4NTAxIn0=&data=J9sfWOoc7EvNXYx95rO6lqOUxHDLkHtpZTyVmK_2F3CcPhdSUA49dS2oe4Ws4KFjDo8nbfeL0HZ8E7-GoA-L7yDclR-8-tc6rvk4BStmQq4&svctype=5&tempid=h5_group_info", text: "加入QQ4群" },
						{ url: "https://discord.gg/ba9rC7Qdkb", text: "加入Discord！（需要您会魔法）" }
					]
				}
			},
			{
				rank: 1,
				name: "Team Sparks Il PvZ2 Modders（需要魔法）",
				score: "8分 一个由画师和模组作者组成的团队，致力于创建、动画和编写素材，供模组社区免费使用!",
				downloadUrl: "https://discord.gg/fAuHJNRM2y",
				image: "TeamSpark.jpg",
				downloadText: "前往",
				popup: {
					text: "加入官方Discord社区！",
					downloads: [
						{ url: "https://discord.gg/fAuHJNRM2y", text: "加入Discord" }
					]
				}
			},
			{
				rank: 1,
				name: "植物大战僵尸2：迷宫回响",
				score: "7.9分  一款不错的迷宫改版，内含丰富的游戏内容！",
				downloadUrl: "",
				image: "植物大战僵尸2迷宫回响.jpg",
				downloadText: "前往",
				popup: {
					text: "加入官方群！在群内获取游戏资源",
					downloads: [
						{
							url: "https://qun.qq.com/universal-share/share?ac=1&authKey=cvrccBe19rE5c9UGSdpw7ZphWwWT1GHHlThgDodYXqVkSyDgW9FQP%2BKKWYii1rVk&busi_data=eyJncm91cENvZGUiOiI4MzIyODcwOTgiLCJ0b2tlbiI6Im1Xb3ZwMWI5dEVlbkxaL2pzQllkaC9JWS9lbGJ6M1hsaGkyK2VqVndReXFBQy9RVHBPUVlId2NDbVNTRlFlTEciLCJ1aW4iOiIxMzIyMDMzNTkyIn0=&data=oi3-XRWXuYVNGnErhbB3YMpemyq_gnifJmv3NtJNXfPxB3riOG97HAeXzQBiEobSQaMNPjGzKHgUjG1Hu0StcV3D9gw3VD2QsMXZMow3iUM&svctype=5&tempid=h5_group_info",
							text: "加入QQ交流群获取"
						}
					]
				}
			},
			{
				rank: 1,
				name: "植物大战僵尸2：迷宫拓展版",
				score: "8.1分  完成度很的迷宫改版，拥有妙趣横生的游戏体验！",
				downloadUrl: "",
				image: "植物大战僵尸2迷宫拓展.jpg",
				downloadText: "前往",
				popup: {
					text: "加入官方QQ群！下载最新游戏资源",
					downloads: [
						{
							url: "https://qun.qq.com/universal-share/share?ac=1&authKey=4CX14sTwi007tFiMdmoY8%2BdRZ9MPsDJ0gKuxL850OQw6xP6KVOQvnmGCQM/vp%2B4g&busi_data=eyJncm91cENvZGUiOiIxMDQ0OTMyNjM2IiwidG9rZW4iOiJLSDU3Z2padlhlMVFaR2lScjJCM3FkVGMxN1NTM2NtWHl3bkNXRGlpbUxRMVZLUktxcHlJbEFpV2dZRzJpMCtpIiwidWluIjoiMjAxOTk0NzA4NSJ9&data=yf5Zly7jOcjnvn1SGtouhSK2YIFKTngQnOP17PrbdFKVQ6HM0r_QR8oYjYJNJEblDLZm_Q91KN4cuTVxFk-FNUSrUSfTT7nPJWx-YLAwvQ8&svctype=5&tempid=h5_group_info",
							text: "查看群简介，加入拓展QQ官方群"
						},
						{
							url: "https://1drv.ms/f/c/ca303ad2d43918b2/ErIYOdTSOjAggMqpAAAAAAABaYJBklXNYVebE24ZXcG_yQ",
							text: "使用onedrive在线下载（需要魔法）"
						}
					]
				}
			},
			{
				rank: 1,
				name: "小马宝莉大战僵尸5",
				score: "8.6分  小马宝莉大战僵尸的第五部，小马大战僵尸收官之作！",
				downloadUrl: "",
				image: "植物大战僵尸2小马.jpg",
				downloadText: "前往",
				popup: {
					text: "经多年守卫控住僵尸，但小马谷已成废墟。星光熠熠决定穿越到第一天剿灭僵尸，重启时空扭转残局！",
					downloads: [
						{
							url: "https://qun.qq.com/universal-share/share?ac=1&authKey=ICKWdXFQqBR%2BaHrB9/JPygRkqF6DEspJxwRCDW/D74YpMuDTGYQfhaPWiU8sOKmu&busi_data=eyJncm91cENvZGUiOiI1NDc2NTgyOTUiLCJ0b2tlbiI6ImZHSUpDT09Zc2tmYWt2aXRHY0ZDZy9hMW5ibFBFd1VpRnFkWWlQR0dxTzRCZ1k5aE1CSE5zS2pGQW1GT2huTCsiLCJ1aW4iOiIyMDE5OTQ3MDg1In0=&data=ZbIpXGFKVTxPpzZ6cgQI-1O9cD5gWFfsfbf4cNwmOUJIA1Hy9D-UzcjY135YMCmtzfBl4RIulZJJbU5AIseRT8cIvcvCgWXIS0aFTmLLago&svctype=5&tempid=h5_group_info",
							text: "加入QQ官方群获取"
						},
						{
							url: "https://www.123684.com/s/zWgIjv-tcA8",
							text: "在线123云盘下载"
						}
					]
				}
			},
			{
				rank: 1,
				name: "植物大战僵尸2天空之城内购破解",
				score: "7.9分  经典迷宫版v1.6.1内购破解版！无须花钱即可获取资源 此版本纯琨曲！",
				downloadUrl: "https://www.123684.com/s/zWgIjv-VcA8",
				image: "植物大战僵尸2天空之城.jpg"
			},
			{
				rank: 1,
				name: "植物大战僵尸无尽版内购破解",
				score: "7.7分  经典一代官方版本内购破解，包含西游、龙宫、长城三大内容！",
				downloadUrl: "https://www.123684.com/s/zWgIjv-VcA8",
				image: "植物大战僵尸无尽版.jpg",
				popup: {
					text: "该版本较为远古，内购破解会闪退，但可正常到账。高系统手机启动时小概率闪退，但第三次必定进入。",
					downloads: [
						{
							url: "https://www.123684.com/s/zWgIjv-deA8",
							text: "云盘下载"
						}
					]
				}
			},
			{
				rank: 1,
				name: "植物大战僵尸2失落之城1.7.5",
				score: "8.2分  内含内购破解、画质高清修复！作者：玉米，7000i，屑fell",
				downloadUrl: "https://www.123684.com/s/zWgIjv-VcA8",
				image: "植物大战僵尸2失落之城.jpg",
				popup: {
					text: "1.7.5经典迷宫版本！内含内购破解、画质高清修复！是最后一个迷宫版本！",
					downloads: [
						{
							url: "https://www.123684.com/s/zWgIjv-mzA8",
							text: "123云盘下载"
						}
					]
				}
			},
			{
				rank: 1,
				name: "植物大战僵尸全明星qwq版",
				score: "8.5分  经典全明星版本的改版！内涵丰富内容和无与伦比的新奇体验",
				downloadUrl: "",
				image: "植物大战僵尸全明星qwq.jpg",
				downloadText: "前往",
				popup: {
					text: "加入官方群！在群内获取游戏资源",
					downloads: [
						{
							url: "https://qun.qq.com/universal-share/share?ac=1&authKey=VrThaikUN6pnRjni858gy8f7Dc7VrkJcRHHAgfT6wVFp6l6Q6x2ZUy7pYeaiqK2k&busi_data=eyJncm91cENvZGUiOiIxMDUzMjcwMzA2IiwidG9rZW4iOiJpSHcxWmlaL1d6N0ovU2tKSGVtMXplM2pXZFI1RDlsYWdKYTBzTDBZZGpacy95ZW13MDF1UGVVK0VoNVZIa1ZTIiwidWluIjoiMjAxOTk0NzA4NSJ9&data=_U9WSDDR7BNvN6vDUl-XmJCqSen9uSB2caP3hsd34DiAb6547Uu7ZxlAFXaFobAnkeeTggnrreyN_6ZU46IZsTtk1sRnumBcbAIcYr9UCLo&svctype=5&tempid=h5_group_info",
							text: "加入QQ交流群获取"
						}
					]
				}
			},
			{
				rank: 1,
				name: "Plants vs Zombies：Brave New World",
				score: "8.8分  目前仅支持电脑端游玩，加入群聊在群文件中下载游戏包",
				downloadUrl: "",
				image: "PlantsvsZombies：BraveNewWorld.jpg",
				downloadText: "前往",
				popup: {
					text: "《植物大战僵尸：美丽新世界》重拾系列经典玩法。开放更多的自定义插件项目，带来无与伦比的体验。玩家将再度开启跨时空冒险，收集并运用植物，全力抵御僵尸浪潮的入侵，重温原味塔防体验。",
					downloads: [
						{
							url: "https://qun.qq.com/universal-share/share?ac=1&authKey=is9p6%2B3SPyFTida4NFvw7i0tXajcjzykKvSxGxWE1L2SDOIJ%2BIfGBt3Ig70fER53&busi_data=eyJncm91cENvZGUiOiI4NTczMTMyNDIiLCJ0b2tlbiI6IktZSGpPYjNHSktzTWc2R3dGMC9xTDJIOE1XUlRGNEhuTGtyaGV6UDFweDVvczJsS1BsNVlJZHhDcGxFSnQ0TVAiLCJ1aW4iOiIyMDE5OTQ3MDg1In0%3D&data=iQTw8uCwcF3AppkQOBukZqTGn_atXnV6xITfVNzviz5VXsFlzS6L_ihYtcs3xNAGsBQdmT7G7qVM9jN5gyLeIw&svctype=4&tempid=h5_group_info",
							text: "点击加群获取"
						}
					]
				}
			},
			{
				rank: 1,
				name: "植物大战僵尸：乐Pad版",
				score: "6.8分 在一众一代版本中，此版本十分高清！对高版本系统的适配也是一流的。",
				downloadUrl: "",
				image: "植物大战僵尸乐pad版.jpg",
				downloadText: "前往",
				popup: {
					text: "版本相对于原版没有花园、解谜元素，但是在关卡中会出现灌木丛。而对比移动端的其他版本，这个版本的特点在于支持1280x800分辨率画面。且对于PAD的适配更好！",
					downloads: [
						{
							url: "https://www.123684.com/s/zWgIjv-xeA8",
							text: "云盘下载"
						}
					]
				}
			}
		];
		
		
		let translatedSoftwareData = [];
		let sortedSoftware = [];
		const searchInput = document.getElementById('searchInput');
		const searchResultInput = document.getElementById('searchResultInput');
		const softwareListEl = document.getElementById('softwareList');
		const resultSoftwareListEl = document.getElementById('resultSoftwareList');
		const searchResultPage = document.getElementById('searchResultPage');
		const searchText = document.getElementById('searchText');
		const resultSearchText = document.querySelector('.search-result-actions .search-text');
		const historyBtn = document.getElementById('historyBtn');
		const cancelBtn = document.getElementById('cancelBtn');
		const resultCancelBtn = document.getElementById('resultCancelBtn');
		const historyPage = document.getElementById('historyPage');
		const backBtn = document.getElementById('backBtn');
		const historyContent = document.getElementById('historyContent');
		const fullscreenModal = document.getElementById('fullscreenModal');
		const fullscreenModalTitle = document.getElementById('fullscreenModalTitle');
		const fullscreenModalClose = document.getElementById('fullscreenModalClose');
		const fullscreenDesc = document.getElementById('fullscreenDesc');
		const fullscreenScore = document.getElementById('fullscreenScore');
		const imageShowcase = document.getElementById('imageShowcase');
		const imageSlider = document.getElementById('imageSlider');
		const sliderNav = document.getElementById('sliderNav');
		const fullscreenDownloadTitle = document.getElementById('fullscreenDownloadTitle');
		const fullscreenDownloadOptions = document.getElementById('fullscreenDownloadOptions');

		let searchHistory = JSON.parse(localStorage.getItem('searchHistory') || '[]');
		let currentImageIndex = 0;

		function renderSoftwareList(softwareToShow, container = softwareListEl) {
			if (!softwareToShow.length) {
				const noResultsText = isEnglishMode ? 'No software found' : '没有找到相关软件';
				container.innerHTML = `<div class="no-results">${noResultsText}</div>`;
				return;
			}
			const listHTML = softwareToShow.map(item => {
				const btnText = item.downloadText || (isEnglishMode ? 'Download' : '下载');
				let btnHtml = '';
				if (item.popup) {
					btnHtml = `<button class="download-btn-main" onclick="showFullscreenPopup('${item.name}')">${btnText}</button>`;
				} else if (item.downloadUrl && item.downloadUrl.trim() !== '' && item.downloadUrl !== '无') {
					const isHtml = item.downloadUrl.endsWith('.html');
					btnHtml = `<a href="${item.downloadUrl}" class="download-btn-main" target="_blank">${btnText}</a>`;
				} else {
					const noDownloadText = isEnglishMode ? 'No download' : '暂无下载';
					btnHtml = `<span class="download-btn-main" disabled>${noDownloadText}</span>`;
				}
				return `
				<div class="software-item">
					<img src="${item.image}" class="software-img" alt="${item.name}">
					<div class="software-info">
						<div class="software-name">${item.name}</div>
						<div class="software-score">${item.score}</div>
					</div>
					${btnHtml}
				</div>`;
			}).join('');
			container.innerHTML = listHTML;
		}

		function showFullscreenPopup(name) {
			const item = translatedSoftwareData.find(s => s.name === name) || originalSoftwareData.find(s => translateText(s.name) === name);
			if (!item || !item.popup) return;
			fullscreenModalTitle.textContent = item.name;
			fullscreenScore.textContent = item.score;
			if (item.textpng && item.textpng.length > 0) {
				imageShowcase.style.display = 'block';
				renderImageSlider(item.textpng);
			} else {
				imageShowcase.style.display = 'none';
			}
			
			// 设置描述文字内容
			fullscreenDesc.textContent = item.popup.text;
			
			fullscreenDownloadOptions.innerHTML = '';
			if (item.popup.downloads) {
				const titleText = isEnglishMode ? 'Please choose download method:' : '请选择下载方式：';
				fullscreenDownloadTitle.textContent = titleText;
				item.popup.downloads.forEach(opt => {
					const btn = document.createElement('button');
					btn.className = 'fullscreen-download-option';
					btn.textContent = opt.text;
					btn.onclick = () => { opt.url && window.open(opt.url, '_blank'); hideFullscreenModal(); };
					fullscreenDownloadOptions.appendChild(btn);
				});
			} else {
				fullscreenDownloadTitle.textContent = '';
			}
			fullscreenModal.classList.add('active');
		}

		function renderImageSlider(images) {
			imageSlider.innerHTML = '';
			sliderNav.innerHTML = '';
			images.forEach((src, index) => {
				const img = document.createElement('img');
				img.src = src;
				img.className = 'slider-image';
				img.alt = `展示 ${index + 1}`;
				imageSlider.appendChild(img);
				const dot = document.createElement('div');
				dot.className = 'slider-dot';
				if (index === 0) dot.classList.add('active');
				dot.addEventListener('click', () => goToSlide(index));
				sliderNav.appendChild(dot);
			});
			currentImageIndex = 0;
			updateSliderPosition();
		}

		function updateSliderPosition() {
			const slideWidth = imageSlider.children[0]?.offsetWidth || 0;
			imageSlider.style.transform = `translateX(-${currentImageIndex * slideWidth}px)`;
			document.querySelectorAll('.slider-dot').forEach((dot, index) => {
				dot.classList.toggle('active', index === currentImageIndex);
			});
		}

		function goToSlide(index) {
			if (index >= 0 && index < imageSlider.children.length) {
				currentImageIndex = index;
				updateSliderPosition();
			}
		}

		function nextSlide() {
			currentImageIndex < imageSlider.children.length - 1 && currentImageIndex++;
			updateSliderPosition();
		}

		function prevSlide() {
			currentImageIndex > 0 && currentImageIndex--;
			updateSliderPosition();
		}

		function hideFullscreenModal() {
			fullscreenModal.classList.remove('active');
		}

		function saveSearchHistory(kw) {
			if (!kw.trim()) return;
			searchHistory = searchHistory.filter(h => h.keyword !== kw);
			searchHistory.unshift({ keyword: kw, timestamp: Date.now() });
			searchHistory.length > 10 && (searchHistory = searchHistory.slice(0, 10));
			localStorage.setItem('searchHistory', JSON.stringify(searchHistory));
		}

		function performSearch(kw, container = resultSoftwareListEl) {
			if (!kw.trim()) {
				renderSoftwareList(sortedSoftware, container);
				return;
			}
			saveSearchHistory(kw);
			const filtered = translatedSoftwareData.filter(s => 
				s.name.toLowerCase().includes(kw.toLowerCase()) || 
				originalSoftwareData.find(orig => orig.name.toLowerCase().includes(kw.toLowerCase()) && translateText(orig.name) === s.name)
			);
			renderSoftwareList(filtered, container);
		}

		function showSearchResultPage() {
			searchResultPage.classList.add('active');
			searchResultInput.value = searchInput.value;
			searchResultInput.focus();
		}

		function hideSearchResultPage() {
			searchResultPage.classList.remove('active');
			searchInput.value = '';
			searchResultInput.value = '';
		}

		function renderHistoryPage() {
			if (!searchHistory.length) {
				const emptyText = isEnglishMode ? 'No search history' : '暂无搜索历史';
				historyContent.innerHTML = `<div class="empty-history">${emptyText}</div>`;
				return;
			}
			const shown = new Set();
			let html = '';
			searchHistory.forEach(hist => {
				const results = translatedSoftwareData.filter(s => 
					s.name.toLowerCase().includes(hist.keyword.toLowerCase()) && !shown.has(s.name)
				).slice(0, 2);
				if (!results.length) return;
				results.forEach(r => shown.add(r.name));
				const resHtml = results.map(r => {
					const link = r.downloadUrl && r.downloadUrl.trim() && r.downloadUrl !== '无' ? r.downloadUrl : '#';
					const disabled = (!link || link === '#') ? 'disabled' : '';
					const downloadText = isEnglishMode ? 'Download' : '下载';
					return `
					<div class="history-result-item">
						<img src="${r.image}" class="history-result-img" alt="${r.name}">
						<div class="history-result-info">
							<div class="history-result-name">${r.name}</div>
							<div class="history-result-score">${r.score}</div>
						</div>
						<a href="${link}" class="download-btn-main" target="_blank" ${disabled} style="padding:6px 12px;font-size:12px;">${downloadText}</a>
					</div>`;
				}).join('');
				const searchLabel = isEnglishMode ? 'Search:' : '搜索：';
				html += `
				<div class="history-search-item">
					<div class="history-search-header">
						<div class="history-search-keyword">${searchLabel}<strong>"${hist.keyword}"</strong></div>
						<button class="history-search-btn" onclick="quickSearch('${hist.keyword}')">${isEnglishMode ? 'Search' : '搜索'}</button>
					</div>
					<div class="history-search-results">${resHtml}</div>
				</div>`;
			});
			historyContent.innerHTML = html || `<div class="empty-history">${isEnglishMode ? 'All software displayed above' : '所有软件已在上方显示完毕'}</div>`;
		}

		function quickSearch(kw) {
			historyPage.classList.remove('active');
			searchInput.value = kw;
			searchResultInput.value = kw;
			performSearch(kw, resultSoftwareListEl);
			showSearchResultPage();
			searchResultInput.focus();
		}

		function initLanguageState() {
			checkLanguageState();
			translatedSoftwareData = getTranslatedSoftwareData();
			sortedSoftware = [...translatedSoftwareData].sort((a, b) => {
				const scoreA = parseFloat(a.score.match(/\d+\.?\d*/)[0]) || 0;
				const scoreB = parseFloat(b.score.match(/\d+\.?\d*/)[0]) || 0;
				return scoreB - scoreA;
			});
			updatePageText();
			renderBottomNav();
		}

		function updatePageText() {
			document.getElementById('searchInput').placeholder = isEnglishMode ? 'Search software name' : '搜索软件名称';
			document.getElementById('searchResultInput').placeholder = isEnglishMode ? 'Search software name' : '搜索软件名称';
			document.getElementById('searchText').textContent = isEnglishMode ? 'Search' : '搜索';
			document.querySelector('.search-result-actions .search-text').textContent = isEnglishMode ? 'Search' : '搜索';
			document.getElementById('cancelBtn').textContent = isEnglishMode ? 'Cancel' : '取消';
			document.getElementById('resultCancelBtn').textContent = isEnglishMode ? 'Cancel' : '取消';
			document.querySelector('.history-title').textContent = isEnglishMode ? 'History' : '历史记录';
			document.title = isEnglishMode ? 'Software Search & Download' : '软件搜索下载';
		}

		function init() {
			initLanguageState();
			renderSoftwareList(sortedSoftware);
		}

		init();

		searchInput.addEventListener('focus', showSearchResultPage);
		searchText.addEventListener('click', () => { const kw = searchInput.value.trim(); kw && performSearch(kw, softwareListEl); });
		resultSearchText.addEventListener('click', () => { const kw = searchResultInput.value.trim(); kw && performSearch(kw, resultSoftwareListEl); });
		cancelBtn.addEventListener('click', hideSearchResultPage);
		resultCancelBtn.addEventListener('click', hideSearchResultPage);
		historyBtn.addEventListener('click', () => { renderHistoryPage(); historyPage.classList.add('active'); });
		backBtn.addEventListener('click', () => historyPage.classList.remove('active'));
		[searchResultInput, searchInput].forEach(inp => {
			inp.addEventListener('keypress', e => {
				if (e.key === 'Enter') {
					const kw = inp.value.trim();
					const targetContainer = inp.id === 'searchResultInput' ? resultSoftwareListEl : softwareListEl;
					kw && performSearch(kw, targetContainer);
				}
			});
			inp.addEventListener('input', () => {
				const other = inp.id === 'searchInput' ? searchResultInput : searchInput;
				other.value = inp.value;
			});
		});
		fullscreenModalClose.addEventListener('click', hideFullscreenModal);
		fullscreenModal.addEventListener('click', e => e.target === fullscreenModal && hideFullscreenModal());
		let startX = 0;
		imageSlider.addEventListener('touchstart', e => startX = e.touches[0].clientX);
		imageSlider.addEventListener('touchend', e => {
			const endX = e.changedTouches[0].clientX;
			const diffX = startX - endX;
			Math.abs(diffX) > 50 && (diffX > 0 ? nextSlide() : prevSlide());
		});

		window.showFullscreenPopup = showFullscreenPopup;
		window.quickSearch = quickSearch;
	</script>
</body>
</html>
<!DOCTYPE html>
<html lang="zh-CN">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>
<body>
	<script>
		if(localStorage.getItem('isOnlineDataEnabled')==='true'){
			localStorage.setItem('isOnlineDataEnabled','false');
			location.href='./indexonline.html';
		}
	</script>
</body>
</html>