<!-- é¡¶éƒ¨åŠŸèƒ½å¯¼èˆªæ¡ - ç²˜è´´åˆ°é¡µé¢æœ€ä¸Šæ–¹ -->
<style>
	/* é¡¶éƒ¨å¯¼èˆªæ¡æ ·å¼ */
	.top-feature-bar {
		position: relative;
		width: 100%;
		background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
		color: white;
		padding: 20px 0;
		box-shadow: 0 2px 20px rgba(0, 0, 0, 0.1);
		margin-bottom: 30px;
		z-index: 1000;
		transition: all 0.3s ease;
	}
	
	.feature-container {
		max-width: 1200px;
		margin: 0 auto;
		padding: 0 20px;
	}
	
	.feature-header {
		display: flex;
		align-items: center;
		gap: 10px;
		margin-bottom: 20px;
	}
	
	.feature-title {
		font-size: 24px;
		font-weight: bold;
		display: flex;
		align-items: center;
		gap: 8px;
	}
	
	.new-badge {
		background: #ff4757;
		color: white;
		font-size: 12px;
		padding: 2px 8px;
		border-radius: 12px;
		font-weight: bold;
	}
	
	.feature-content {
		display: grid;
		grid-template-columns: 1fr 1fr;
		gap: 20px;
		background: rgba(255, 255, 255, 0.1);
		border-radius: 12px;
		padding: 20px;
		backdrop-filter: blur(10px);
	}
	
	.feature-divider {
		width: 1px;
		background: rgba(255, 255, 255, 0.3);
		margin: 0 10px;
	}
	
	.feature-card {
		background: rgba(255, 255, 255, 0.15);
		border-radius: 10px;
		padding: 20px;
		cursor: pointer;
		transition: all 0.3s ease;
		border: 2px solid transparent;
	}
	
	.feature-card:hover {
		background: rgba(255, 255, 255, 0.25);
		transform: translateY(-3px);
		border-color: rgba(255, 255, 255, 0.3);
		box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
	}
	
	.feature-card-left:hover {
		border-left-color: #4cd137;
	}
	
	.feature-card-right:hover {
		border-right-color: #00a8ff;
	}
	
	.feature-icon {
		font-size: 36px;
		margin-bottom: 10px;
	}
	
	.feature-card h3 {
		font-size: 18px;
		font-weight: 600;
		margin-bottom: 8px;
		display: flex;
		align-items: center;
		gap: 8px;
	}
	
	.feature-card p {
		font-size: 14px;
		opacity: 0.9;
		line-height: 1.5;
	}
	
	.feature-link {
		text-decoration: none;
		color: white;
		display: block;
	}
	
	.feature-link:hover {
		color: white;
	}
	
	/* å“åº”å¼è®¾è®¡ */
	@media (max-width: 768px) {
		.feature-content {
			grid-template-columns: 1fr;
		}
		
		.feature-divider {
			display: none;
		}
		
		.feature-title {
			font-size: 20px;
		}
	}
	
	/* å…³é—­æŒ‰é’® */
	.close-feature-bar {
		position: absolute;
		top: 15px;
		right: 20px;
		background: rgba(255, 255, 255, 0.2);
		border: none;
		color: white;
		width: 30px;
		height: 30px;
		border-radius: 50%;
		cursor: pointer;
		font-size: 16px;
		display: flex;
		align-items: center;
		justify-content: center;
		transition: all 0.3s ease;
		z-index: 1001;
	}
	
	.close-feature-bar:hover {
		background: rgba(255, 255, 255, 0.3);
		transform: rotate(90deg);
	}
</style>

<div class="top-feature-bar" id="topFeatureBar">
	<button class="close-feature-bar" onclick="closeFeatureBar()">Ã—</button>
	<div class="feature-container">
		<div class="feature-header">
			<div class="feature-title">
				<span>ğŸ”¥ æ–°åŠŸèƒ½</span>
				<span class="new-badge">NEW</span>
			</div>
		</div>
		
		<div class="feature-content">
			<!-- å·¦ä¾§ï¼šå­˜æ¡£ä¿®æ”¹åŠŸèƒ½ -->
			<a href="å­˜æ¡£ä¿®æ”¹.html" class="feature-link">
				<div class="feature-card feature-card-left">
					<div class="feature-icon">ğŸ’¾</div>
					<h3><span>ğŸ“</span> å­˜æ¡£ä¿®æ”¹å™¨</h3>
					<p>ä¸“é—¨ç”¨äºä¿®æ”¹ã€Šæ¤ç‰©å¤§æˆ˜åƒµå°¸2ã€‹å­˜æ¡£æ–‡ä»¶<br>å¿«é€Ÿä¿®æ”¹é‡‘å¸(c)å’Œé’»çŸ³(g)æ•°é‡<br>æ”¯æŒPP.datæ–‡ä»¶ä¸€é”®ç¼–è¾‘</p>
				</div>
			</a>
			
			<div class="feature-divider"></div>
			
			<!-- å³ä¾§ï¼šJSON/RTONè½¬æ¢ -->
			<a href="json&rton.html" class="feature-link">
				<div class="feature-card feature-card-right">
					<div class="feature-icon">ğŸ”„</div>
					<h3><span>âš¡</span> æ ¼å¼è½¬æ¢å™¨</h3>
					<p>RTONä¸JSONæ ¼å¼åŒå‘è½¬æ¢<br>æ”¯æŒã€Šæ¤ç‰©å¤§æˆ˜åƒµå°¸2ã€‹æ¸¸æˆæ–‡ä»¶<br>å®Œæ•´è§£æåº“ï¼Œä¸“ä¸šå¯é </p>
				</div>
			</a>
		</div>
	</div>
</div>

<script>
	// ä½¿ç”¨ä¼šè¯å­˜å‚¨ä»£æ›¿æœ¬åœ°å­˜å‚¨ï¼Œè¿™æ ·æ¯æ¬¡æµè§ˆå™¨ä¼šè¯éƒ½ä¼šé‡æ–°æ˜¾ç¤º
	const SESSION_STORAGE_KEY = 'featureBarSessionClosed';
	
	// å…³é—­åŠŸèƒ½æ 
	function closeFeatureBar() {
		const bar = document.getElementById('topFeatureBar');
		bar.style.opacity = '0';
		bar.style.transform = 'translateY(-20px)';
		bar.style.marginBottom = '0';
		bar.style.padding = '0';
		bar.style.overflow = 'hidden';
		
		setTimeout(() => {
			bar.style.display = 'none';
			// ä½¿ç”¨sessionStorageï¼Œåªåœ¨å½“å‰æµè§ˆå™¨ä¼šè¯ä¸­è®°ä½å…³é—­çŠ¶æ€
			sessionStorage.setItem(SESSION_STORAGE_KEY, 'true');
		}, 300);
	}
	
	// é¡µé¢åŠ è½½æ—¶æ£€æŸ¥
	window.addEventListener('load', function() {
		// ä½¿ç”¨sessionStorageï¼Œæ¯æ¬¡æ–°ä¼šè¯éƒ½ä¼šé‡æ–°æ˜¾ç¤º
		// åªåœ¨å½“å‰æ ‡ç­¾é¡µå…³é—­å‰æœ‰æ•ˆ
		if (sessionStorage.getItem(SESSION_STORAGE_KEY) === 'true') {
			// å¦‚æœä¹‹å‰åœ¨å½“å‰ä¼šè¯ä¸­å…³é—­è¿‡ï¼Œåˆ™ä¸æ˜¾ç¤º
			document.getElementById('topFeatureBar').style.display = 'none';
		} else {
			// æ–°ä¼šè¯ï¼Œç¡®ä¿æ˜¾ç¤º
			document.getElementById('topFeatureBar').style.display = 'block';
			document.getElementById('topFeatureBar').style.opacity = '1';
		}
		
		// é«˜äº®å½“å‰é¡µé¢
		highlightCurrentPage();
	});
	
	// é«˜äº®å½“å‰é¡µé¢
	function highlightCurrentPage() {
		const currentPage = window.location.pathname.split('/').pop();
		
		if (currentPage === 'å­˜æ¡£ä¿®æ”¹.html') {
			const leftCard = document.querySelector('.feature-card-left');
			if (leftCard) {
				leftCard.style.background = 'rgba(76, 209, 55, 0.3)';
				leftCard.style.borderColor = '#4cd137';
			}
		} else if (currentPage === 'json&rton.html') {
			const rightCard = document.querySelector('.feature-card-right');
			if (rightCard) {
				rightCard.style.background = 'rgba(0, 168, 255, 0.3)';
				rightCard.style.borderColor = '#00a8ff';
			}
		}
	}
	
	// å½“ç”¨æˆ·ç¦»å¼€é¡µé¢æ—¶ï¼Œä¸æ¸…é™¤sessionStorageï¼Œä¿æŒå…³é—­çŠ¶æ€ç›´åˆ°æµè§ˆå™¨å…³é—­
	window.addEventListener('beforeunload', function() {
		// ä¿æŒsessionStorageä¸å˜
	});
	
	// å¦‚æœé¡µé¢æ˜¯é€šè¿‡å‰è¿›/åé€€æŒ‰é’®å¯¼èˆªçš„ï¼Œé‡æ–°æ£€æŸ¥é«˜äº®
	window.addEventListener('pageshow', function(event) {
		if (event.persisted) {
			highlightCurrentPage();
		}
	});
</script>
<!DOCTYPE html>
<html lang="zh-CN">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>å®‰å“äºŒä»£ä¸­æ–‡ç‰ˆ - æ›´æ–°æ—¥å¿—</title>
	<style>
		* {
			margin: 0;
			padding: 0;
			box-sizing: border-box;
		}

		body {
			font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', sans-serif;
			background-color: #ffffff;
			color: #333333;
			line-height: 1.6;
			min-height: 100vh;
		}

		/* æ–°å¢ï¼šå†…å®¹åŒ…è£…å™¨ï¼Œæ•´ä½“ä¸Šç§»é¿å¼€å¯¼èˆªæ  */
		.content-wrapper {
			padding-bottom: 60px; /* ä¸ºåº•éƒ¨å¯¼èˆªæ ç•™å‡ºç©ºé—´ */
			min-height: 100vh;
		}

		.container {
			max-width: 800px;
			margin: 0 auto;
			padding: 40px 20px;
		}

		.header {
			text-align: center;
			margin-bottom: 50px;
			border-bottom: 2px solid #f5f5f5;
			padding-bottom: 30px;
		}

		.header h1 {
			font-size: 2.5rem;
			font-weight: 300;
			color: #2c3e50;
			margin-bottom: 10px;
		}

		.header p {
			font-size: 1rem;
			color: #7f8c8d;
			font-weight: 300;
		}

		.update-log {
			background: #ffffff;
			border-radius: 8px;
			box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
			overflow: hidden;
		}

		.log-content {
			padding: 40px;
			white-space: pre-wrap;
			font-family: 'Consolas', 'Monaco', 'Courier New', monospace;
			font-size: 14px;
			line-height: 1.8;
			background: #fafafa;
			border-left: 4px solid #3498db;
			margin: 20px 0;
		}

		.loading {
			text-align: center;
			padding: 60px 20px;
			color: #7f8c8d;
			font-size: 1.1rem;
		}

		.error {
			text-align: center;
			padding: 60px 20px;
			color: #e74c3c;
			background: #fdf2f2;
			border-radius: 8px;
			margin: 20px 0;
		}

		.retry-btn {
			background: #3498db;
			color: white;
			border: none;
			padding: 12px 24px;
			border-radius: 6px;
			cursor: pointer;
			font-size: 14px;
			margin-top: 15px;
			transition: background 0.3s ease;
		}

		.retry-btn:hover {
			background: #2980b9;
		}

		.footer {
			text-align: center;
			margin-top: 50px;
			padding-top: 30px;
			padding-bottom: 20px;
			border-top: 1px solid #f5f5f5;
			color: #95a5a6;
			font-size: 0.9rem;
		}

		/* å…¨å±é®ç½© - å·²ä¿®å¤ï¼šè°ƒæ•´é«˜åº¦é¿å¼€å¯¼èˆªæ  */
		.version-overlay {
			position: fixed;
			top: 0;
			left: 0;
			width: 100%;
			/* å…³é”®ä¿®å¤ï¼šå‡å»å¯¼èˆªæ é«˜åº¦ï¼Œé¿å…è¢«é®æŒ¡ */
			height: calc(100% - 60px);
			background: rgba(255, 255, 255, 0.95);
			z-index: 10000; /* æé«˜åˆ°æ¯”å¯¼èˆªæ æ›´é«˜çš„å±‚çº§ */
			display: none;
			overflow-y: auto;
			opacity: 0;
			transition: opacity 0.3s ease-in-out;
			/* æ·»åŠ åº•éƒ¨å†…è¾¹è·ï¼Œç¡®ä¿å†…å®¹ä¸è¢«å¯¼èˆªæ æˆªæ–­ */
			padding-bottom: 60px;
			box-sizing: content-box;
		}

		.version-overlay.active {
			display: block;
			opacity: 1;
		}

		/* é®ç½©å¤´éƒ¨ - æ–°å¢æ»šåŠ¨éšè—åŠŸèƒ½ */
		.overlay-header {
			position: sticky;
			/* è°ƒæ•´é¡¶éƒ¨ä½ç½®ï¼Œé¿å…å¤ªé è¿‘è¾¹ç¼˜ */
			top: 10px;
			background: rgba(255, 255, 255, 0.98);
			padding: 20px;
			border-bottom: 1px solid #eee;
			text-align: center;
			z-index: 10001;
			transform: translateY(-20px);
			transition: all 0.3s ease-in-out 0.1s;
			/* æ–°å¢ï¼šæ»šåŠ¨éšè—ç›¸å…³å±æ€§ */
			overflow: hidden;
		}

		.version-overlay.active .overlay-header {
			transform: translateY(0);
		}

		/* æ–°å¢ï¼šå¤´éƒ¨éšè—çŠ¶æ€ */
		.overlay-header.hidden {
			max-height: 0;
			padding-top: 0;
			padding-bottom: 0;
			opacity: 0;
			transform: translateY(-100%);
		}

		.overlay-title {
			font-size: 1.5rem;
			color: #2c3e50;
			margin-bottom: 10px;
			transition: opacity 0.3s ease;
		}

		.overlay-header.hidden .overlay-title {
			opacity: 0;
		}

		.close-btn {
			background: #e74c3c;
			color: white;
			border: none;
			padding: 8px 16px;
			border-radius: 4px;
			cursor: pointer;
			font-size: 14px;
			transition: all 0.3s ease;
		}

		.close-btn:hover {
			background: #c0392b;
		}

		/* ç‰ˆæœ¬å·ç½‘æ ¼å¸ƒå±€ - å·²ä¿®å¤ï¼šå¢åŠ åº•éƒ¨é—´è· */
		.version-grid {
			display: grid;
			grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
			gap: 15px;
			padding: 30px;
			/* å…³é”®ä¿®å¤ï¼šå¢åŠ åº•éƒ¨å†…è¾¹è·ï¼Œä¸ºå¯¼èˆªæ ç•™å‡ºç©ºé—´ */
			padding-bottom: 80px;
			max-width: 800px;
			margin: 0 auto;
			transform: translateY(20px);
			transition: transform 0.3s ease-in-out 0.2s;
		}

		.version-overlay.active .version-grid {
			transform: translateY(0);
		}

		.version-item {
			background: #f8f9fa;
			border: 2px solid #e9ecef;
			border-radius: 8px;
			padding: 15px;
			text-align: center;
			cursor: pointer;
			transition: all 0.3s ease;
			font-family: 'Consolas', 'Monaco', 'Courier New', monospace;
			font-size: 16px;
			font-weight: bold;
			color: #495057;
			transform: scale(0.9);
			animation: fadeInScale 0.4s ease forwards;
		}

		/* ä¸ºæ¯ä¸ªç‰ˆæœ¬é¡¹æ·»åŠ å»¶è¿ŸåŠ¨ç”» */
		.version-item:nth-child(1) { animation-delay: 0.1s; }
		.version-item:nth-child(2) { animation-delay: 0.15s; }
		.version-item:nth-child(3) { animation-delay: 0.2s; }
		.version-item:nth-child(4) { animation-delay: 0.25s; }
		.version-item:nth-child(5) { animation-delay: 0.3s; }
		.version-item:nth-child(6) { animation-delay: 0.35s; }
		.version-item:nth-child(n+7) { animation-delay: 0.4s; }

		@keyframes fadeInScale {
			to {
				transform: scale(1);
				opacity: 1;
			}
		}

		.version-item:hover {
			background: #007bff;
			color: white;
			border-color: #007bff;
			transform: translateY(-2px) scale(1.02);
			box-shadow: 0 4px 12px rgba(0, 123, 255, 0.3);
		}

		/* ç‰ˆæœ¬å·é“¾æ¥æ ·å¼ */
		.version-link {
			color: #e74c3c;
			font-weight: bold;
			text-decoration: underline;
			cursor: pointer;
			padding: 2px 4px;
			border-radius: 3px;
			transition: background 0.3s ease;
		}

		.version-link:hover {
			background: #e74c3c;
			color: white;
		}

		/* é«˜äº®å½“å‰æŸ¥çœ‹çš„ç‰ˆæœ¬ */
		.highlighted-version {
			background: #fff3cd !important;
			border-color: #ffeaa7 !important;
			animation: pulse 1s infinite;
		}

		@keyframes pulse {
			0% { transform: scale(1); }
			50% { transform: scale(1.02); }
			100% { transform: scale(1); }
		}

		/* è¢«è¿‡æ»¤çš„ç‰ˆæœ¬å·æ ·å¼ */
		.filtered-version {
			color: #ccc !important;
			text-decoration: line-through !important;
			cursor: not-allowed !important;
			background: transparent !important;
		}

		.filtered-version:hover {
			background: transparent !important;
			color: #ccc !important;
		}

		/* ===== å¤–éƒ¨å¯¼èˆªæ å®¹å™¨æ ·å¼ ===== */
		#external-nav {
			position: fixed;
			bottom: 0;
			left: 0;
			width: 100%;
			height: 60px;
			z-index: 9999;
			border-top: 1px solid #e5e5e5;
		}

		/* å¯¼èˆªæ å†…éƒ¨å…ƒç´ æ ·å¼è¦†ç›– */
		#external-nav .bottom-nav {
			width: 100%;
			height: 100%;
			background-color: #fff;
			display: flex;
			justify-content: space-around;
			align-items: center;
			border-top: 1px solid #e5e5e5;
			margin: 0;
			padding: 0;
		}

		#external-nav .nav-item {
			display: flex;
			flex-direction: column;
			align-items: center;
			justify-content: center;
			flex: 1;
			height: 100%;
			text-decoration: none;
			color: #999;
			transition: color 0.3s;
			pointer-events: auto;
			white-space: nowrap;
		}

		#external-nav .nav-item.active {
			color: #4CAF50;
		}

		#external-nav .nav-icon {
			width: 24px;
			height: 24px;
			margin-bottom: 4px;
			font-size: 20px;
			display: flex;
			align-items: center;
			justify-content: center;
		}

		#external-nav .nav-icon img {
			width: 100%;
			height: 100%;
			object-fit: contain;
			transition: opacity 0.3s;
		}

		#external-nav .nav-text {
			font-size: 12px;
			-webkit-font-smoothing: antialiased;
		}

		.wechat-notification,
		.copy-success-modal,
		.modal-overlay,
		.terms-overlay,
		.loading-overlay,
		.nav-safe-indicator {
			display: none !important;
		}
		/* ===== å¯¼èˆªæ æ ·å¼ç»“æŸ ===== */

		@media (max-width: 768px) {
			.container {
				padding: 20px 15px;
			}
			
			.header h1 {
				font-size: 2rem;
			}
			
			.log-content {
				padding: 20px;
				font-size: 13px;
			}
			
			.version-grid {
				grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
				padding: 20px;
				gap: 10px;
				/* ç§»åŠ¨ç«¯ä¹Ÿä¿æŒè¶³å¤Ÿçš„åº•éƒ¨é—´è· */
				padding-bottom: 90px;
			}
			
			.version-item {
				font-size: 14px;
				padding: 12px;
			}
			
			/* ç§»åŠ¨ç«¯é®ç½©è°ƒæ•´ */
			.version-overlay {
				height: calc(100% - 60px);
				padding-bottom: 70px;
			}
			
			.overlay-header {
				top: 5px;
				padding: 15px;
			}
			
			.overlay-title {
				font-size: 1.3rem;
			}
		}
	</style>
</head>
<body>
	<!-- æ–°å¢ï¼šå†…å®¹åŒ…è£…å™¨ï¼Œå°†æ•´ä¸ªå†…å®¹å‘ä¸Šæ¨ -->
	<div class="content-wrapper">
		<div class="container">
			<div class="header">
				<h1>å®‰å“ä¸­æ–‡ç‰ˆæ›´æ–°æ—¥å¿—</h1>
				<p>ç‚¹ç‰ˆæœ¬å·å¯å¿«é€Ÿè·³è½¬ | çˆ±æ¥è‡ªçº¢èŒ¶</p>
			</div>

			<div id="content">
				<div class="loading">
					æ­£åœ¨åŠ è½½æ›´æ–°æ—¥å¿—...
				</div>
			</div>

			<div class="footer">
				<p>&copy; 2025 å®‰å“2ä»£ä¸­æ–‡ç‰ˆ - ä¸ä¼šæ˜¯ç®€å•çš„æ±‰åŒ–</p>
			</div>
		</div>

		<!-- ç‰ˆæœ¬å·é€‰æ‹©é®ç½© - å·²ä¿®å¤æ˜¾ç¤ºé—®é¢˜ -->
		<div class="version-overlay" id="versionOverlay">
			<div class="overlay-header" id="overlayHeader">
				<div class="overlay-title">è·³è½¬ç›®å½•</div>
				<button class="close-btn" onclick="closeVersionOverlay()">å…³é—­</button>
			</div>
			<div class="version-grid" id="versionGrid"></div>
		</div>
	</div>

	<!-- å¤–éƒ¨å¯¼èˆªæ å®¹å™¨ -->
	<div id="external-nav"></div>

	<script>
		// ================== é…ç½®åŒº ==================
		const CACHE_EXPIRY_MS = 10 * 60 * 1000; // ç¼“å­˜ä¿å­˜æ—¶é—´ï¼š10åˆ†é’Ÿ
		const CHECK_INTERVAL_MS = 5 * 60 * 1000; // å…œåº•æ£€æŸ¥ï¼šæ¯5åˆ†é’Ÿ
		const STORAGE_KEY = 'lastUnloadTime';
		// ===========================================

		// ã€å¯¼èˆªæ é…ç½®å’Œæ•°æ®ã€‘
		let NAV_CONFIG = [];
		let navigationLoaded = false;

		// é»˜è®¤å¯¼èˆªé…ç½®ï¼ˆä½œä¸ºåå¤‡æ–¹æ¡ˆï¼‰
		const DEFAULT_NAV_CONFIG = [
			{
				icon: 'home.png',
				text: { zh: 'ä¸»é¡µ', en: 'Home' },
				link: 'indexhome.html',
				active: true,
			},
			{
				icon: 'author.png',
				text: { zh: 'å‘ç°', en: 'Discover' },
				link: 'index2.html',
			},
			{
				icon: 'my.png',
				text: { zh: 'æˆ‘çš„', en: 'Profile' },
				link: 'index3.html',
			},
		];

		let isEnglishMode = false;

		// åŠ è½½å¤–éƒ¨å¯¼èˆªæ 
		async function loadNavigation() {
			try {
				const response = await fetch('./å¯¼èˆªæ .html');
				if (!response.ok) throw new Error('æ— æ³•åŠ è½½å¯¼èˆªæ æ–‡ä»¶');
				
				const htmlContent = await response.text();
				
				// ä½¿ç”¨DOMParserè§£æHTML
				const parser = new DOMParser();
				const doc = parser.parseFromString(htmlContent, 'text/html');
				
				// æ‰¾åˆ°å¯¼èˆªæ å…ƒç´ 
				const navElement = doc.querySelector('.bottom-nav');
				if (navElement) {
					// å°†å¯¼èˆªæ æ’å…¥åˆ°é¡µé¢ä¸­
					const navContainer = document.getElementById('external-nav');
					navContainer.innerHTML = navElement.outerHTML;
					
					// ä¸ºå¯¼èˆªé¡¹æ·»åŠ äº‹ä»¶ç›‘å¬å™¨
					const navItems = navContainer.querySelectorAll('.nav-item');
					navItems.forEach((item, index) => {
						const originalOnclick = item.getAttribute('onclick');
						if (originalOnclick) {
							// æ›¿æ¢onclickäº‹ä»¶ï¼Œä½¿ç”¨æˆ‘ä»¬çš„å¤„ç†å‡½æ•°
							item.removeAttribute('onclick');
							item.addEventListener('click', (e) => {
								const versionMatch = originalOnclick.match(/handleNavigation\((\d+)/);
								if (versionMatch) {
									const navIndex = parseInt(versionMatch[1]);
									handleNavigation(navIndex, e);
								}
							});
						}
					});
				}
				
				// æå–NAV_CONFIGé…ç½®
				extractNavConfig(htmlContent);
				navigationLoaded = true;
				updateBottomNav(); // åˆå§‹åŒ–å¯¼èˆªæ 
				
			} catch (error) {
				console.error('åŠ è½½å¯¼èˆªæ å¤±è´¥:', error);
				// ä½¿ç”¨é»˜è®¤é…ç½®
				NAV_CONFIG = DEFAULT_NAV_CONFIG;
				navigationLoaded = true;
				createFallbackNavigation();
				updateBottomNav();
			}
		}

		// ä»HTMLä¸­æå–NAV_CONFIGé…ç½®
		function extractNavConfig(htmlContent) {
			try {
				// æ›´å¯é çš„æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…
				const configMatch = htmlContent.match(/const\s+NAV_CONFIG\s*=\s*(\[[\s\S]*?\]);/);
				if (configMatch && configMatch[1]) {
					// ä½¿ç”¨Functionæ„é€ å™¨å®‰å…¨åœ°æ‰§è¡Œä»£ç 
					const configFunc = new Function('return ' + configMatch[1]);
					NAV_CONFIG = configFunc();
					console.log('æˆåŠŸæå–å¯¼èˆªé…ç½®:', NAV_CONFIG);
				} else {
					throw new Error('æœªæ‰¾åˆ°NAV_CONFIGé…ç½®');
				}
			} catch (e) {
				console.warn('æ— æ³•æå–å¯¼èˆªæ é…ç½®ï¼Œä½¿ç”¨é»˜è®¤é…ç½®:', e);
				NAV_CONFIG = DEFAULT_NAV_CONFIG;
			}
		}

		// åˆ›å»ºåå¤‡å¯¼èˆªæ 
		function createFallbackNavigation() {
			const navContainer = document.getElementById('external-nav');
			navContainer.innerHTML = `
				<div class="bottom-nav">
					<a href="indexhome.html" class="nav-item active">
						<div class="nav-icon">
							<img src="home.png" alt="ä¸»é¡µ" />
						</div>
						<div class="nav-text">ä¸»é¡µ</div>
					</a>
					<a href="index2.html" class="nav-item">
						<div class="nav-icon">
							<img src="author.png" alt="å‘ç°" />
						</div>
						<div class="nav-text">å‘ç°</div>
					</a>
					<a href="index3.html" class="nav-item">
						<div class="nav-icon">
							<img src="my.png" alt="æˆ‘çš„" />
						</div>
						<div class="nav-text">æˆ‘çš„</div>
					</a>
				</div>
			`;
		}

		function getLanguageState() {
			return localStorage.getItem('isEnglish') === 'true';
		}

		function updateBottomNav() {
			if (!navigationLoaded) return;
			
			isEnglishMode = getLanguageState();
			const navItems = document.querySelectorAll('#external-nav .nav-item');
			
			NAV_CONFIG.forEach((item, index) => {
				const navItem = navItems[index];
				if (!navItem) return;
				
				const text = isEnglishMode ? item.text.en : item.text.zh;
				const iconContainer = navItem.querySelector('.nav-icon');
				const textContainer = navItem.querySelector('.nav-text');
				const img = iconContainer?.querySelector('img');

				if (navItem.href) navItem.href = item.link;
				if (textContainer) textContainer.textContent = text;
				if (img) {
					img.src = item.icon;
					img.alt = text;
				}
				navItem.classList.toggle('active', item.active || false);
			});
		}

		function handleNavigation(index, event) {
			if (!navigationLoaded) return;
			
			event.preventDefault();
			const navItems = document.querySelectorAll('#external-nav .nav-item');
			navItems.forEach((item, i) => {
				item.classList.toggle('active', i === index);
			});
			setTimeout(() => {
				if (NAV_CONFIG[index]) {
					window.location.href = NAV_CONFIG[index].link;
				}
			}, 50);
		}

		// ========== ååˆ†é’Ÿè‡ªåŠ¨æ¸…ç¼“å­˜å¹¶åˆ·æ–° ==========
		function recordUnloadTime() {
			try {
				localStorage.setItem(STORAGE_KEY, Date.now().toString());
			} catch (e) {
				// å¿½ç•¥éšç§æ¨¡å¼/å­˜å‚¨å¼‚å¸¸
			}
		}

		function getLastUnloadTime() {
			try {
				const t = localStorage.getItem(STORAGE_KEY);
				return t ? Number(t) : 0;
			} catch (e) {
				return 0;
			}
		}

		function checkAndRefreshIfExpired() {
			const now = Date.now();
			const last = getLastUnloadTime();
			if (now - last > CACHE_EXPIRY_MS) {
				localStorage.clear();
				sessionStorage.clear();
				window.location.reload();
			}
		}

		function onVisibilityChange() {
			if (document.visibilityState === 'visible') {
				checkAndRefreshIfExpired();
			}
		}

		// å…œåº•ï¼šå®šæ—¶æ£€æŸ¥
		let intervalId = setInterval(checkAndRefreshIfExpired, CHECK_INTERVAL_MS);

		// ç»‘å®šäº‹ä»¶
		document.addEventListener('visibilitychange', onVisibilityChange);
		window.addEventListener('pageshow', onVisibilityChange);
		window.addEventListener('pagehide', recordUnloadTime);
		window.addEventListener('beforeunload', recordUnloadTime);

		// ================== åŸæœ‰åŠŸèƒ½ä¿®æ”¹ä¸º XMLHttpRequest ==================
		// æ–‡ä»¶è·¯å¾„ - è¯·æ ¹æ®å®é™…æ–‡ä»¶ä½ç½®è°ƒæ•´
		const logFileUrl = './å®‰å“äºŒä»£ä¸­æ–‡ç‰ˆæ›´æ–°æ—¥å¿—.txt';
		
		// å­˜å‚¨æ‰€æœ‰ç‰ˆæœ¬å·å’Œå¯¹åº”çš„DOMå…ƒç´ 
		let versionData = [];

		// ç™½åå•ï¼šè¿™äº›ç‰ˆæœ¬å·ä¿æŒåŸæ ·ï¼Œä¸è¿›è¡Œä»»ä½•è½¬æ¢
		const versionWhitelist = new Set([
			'1.1.1', '1.1.2', '2.2.2', '1.1.4', '1.1.5',
			'2.1.1', '1.2.0', '1.8.0',
			'3.1.1', '3.1.2', '3.1.3'
		]);

		// æ»šåŠ¨éšè—åŠŸèƒ½çš„å˜é‡
		let scrollHideEnabled = true;
		let lastScrollTop = 0;
		let scrollThreshold = 10; // æ»šåŠ¨é˜ˆå€¼ï¼Œè¶…è¿‡è¿™ä¸ªè·ç¦»æ‰è§¦å‘éšè—/æ˜¾ç¤º
		let headerHideTimer = null;

		// åŠ è½½å¹¶æ˜¾ç¤ºæ›´æ–°æ—¥å¿—ï¼ˆä½¿ç”¨ XMLHttpRequest å…¼å®¹æ—§æµè§ˆå™¨ï¼‰
		function loadUpdateLog() {
			const contentDiv = document.getElementById('content');
			
			// æ˜¾ç¤ºåŠ è½½ä¸­
			contentDiv.innerHTML = '<div class="loading">æ­£åœ¨åŠ è½½æ›´æ–°æ—¥å¿—...</div>';
			
			// ä½¿ç”¨ XMLHttpRequest æ›¿ä»£ fetchï¼ˆå…¼å®¹æ€§æ›´å¥½ï¼‰
			const xhr = new XMLHttpRequest();
			xhr.open('GET', logFileUrl, true);
			xhr.onreadystatechange = function () {
				if (xhr.readyState === 4) { // è¯·æ±‚å®Œæˆ
					if (xhr.status >= 200 && xhr.status < 300) {
						// æˆåŠŸè·å–å†…å®¹
						const textContent = xhr.responseText;
						
						if (!textContent.trim()) {
							showError('æ–‡ä»¶å†…å®¹ä¸ºç©º');
							return;
						}
						
						// æ ¼å¼åŒ–æ–‡æœ¬å†…å®¹å¹¶æå–ç‰ˆæœ¬å·
						const { formattedContent, versions } = formatLogContentWithVersions(textContent);
						
						contentDiv.innerHTML = `
							<div class="update-log">
								<div class="log-content">${formattedContent}</div>
							</div>
						`;
						
						// å­˜å‚¨ç‰ˆæœ¬æ•°æ®
						versionData = versions;
						
						// ä¸ºç‰ˆæœ¬å·é“¾æ¥æ·»åŠ ç‚¹å‡»äº‹ä»¶
						addVersionClickEvents();
						
					} else {
						// è¯·æ±‚å¤±è´¥
						showError(`æ— æ³•åŠ è½½æ–‡ä»¶ (çŠ¶æ€ç : ${xhr.status})`);
					}
				}
			};
			xhr.onerror = function () {
				showError('ç½‘ç»œé”™è¯¯æˆ–æµè§ˆå™¨é˜»æ­¢äº†æ–‡ä»¶è®¿é—®');
			};
			xhr.send();
		}

		// æ ¼å¼åŒ–æ—¥å¿—å†…å®¹å¹¶æå–ç‰ˆæœ¬å·ï¼ˆåŠ å…¥ç™½åå•ï¼‰
		function formatLogContentWithVersions(content) {
			// è½¬ä¹‰HTMLå­—ç¬¦
			let formatted = content
				.replace(/&/g, '&amp;')
				.replace(/</g, '&lt;')
				.replace(/>/g, '&gt;')
				.replace(/"/g, '&quot;')
				.replace(/'/g, '&#039;');
			
			// æå–ç‰ˆæœ¬å·çš„æ­£åˆ™è¡¨è¾¾å¼ï¼šåŒ¹é… x.xã€x.x.xã€x.x.x.x ç­‰æ ¼å¼
			const versionRegex = /\b(\d+(?:\.\d+)+)\b/g;
			const versions = [];
			const processedVersions = new Set(); // ç”¨äºå»é‡
			
			let match;
			const allMatches = [];
			
			// å…ˆæ”¶é›†æ‰€æœ‰åŒ¹é…çš„ç‰ˆæœ¬å·
			while ((match = versionRegex.exec(formatted)) !== null) {
				allMatches.push({
					version: match[1],
					index: match.index,
					fullMatch: match[0]
				});
			}
			
			// è¿‡æ»¤å’Œå¤„ç†ç‰ˆæœ¬å·
			for (let i = 0; i < allMatches.length; i++) {
				const current = allMatches[i];
				let finalVersion = current.version;
				let shouldFilter = false;
				
				// å¦‚æœåœ¨ç™½åå•ä¸­ï¼Œç›´æ¥ä½¿ç”¨åŸç‰ˆæœ¬å·
				if (versionWhitelist.has(current.version)) {
					finalVersion = current.version;
				} else {
					// è§£æç‰ˆæœ¬å·å„éƒ¨åˆ†
					const parts = finalVersion.split('.');
					const firstPart = parts[0];
					
					// 1. ä¸¥æ ¼ç›¸é‚»é‡å¤æ•°å­—æ£€æµ‹ï¼ˆä»…é’ˆå¯¹ä¸åœ¨ç™½åå•ä¸­çš„ï¼‰
					if (parts.length >= 3) {
						const firstValue = parts[0];
						const allIdentical = parts.every(part => part === firstValue);
						
						if (allIdentical) {
							finalVersion = firstValue; // åªä¿ç•™ç¬¬ä¸€ä¸ªæ•°å­—
						}
					}
					
					// 2. æ£€æŸ¥ä¸»ç‰ˆæœ¬å·æ˜¯å¦å¤§äº3
					const majorVersion = parseInt(firstPart);
					if (majorVersion > 3) {
						shouldFilter = true;
						formatted = formatted.replace(current.fullMatch, `<span class="filtered-version">${current.version}</span>`);
						continue;
					}
					
					// 3. æ£€æŸ¥æ˜¯å¦ä¸ºä»…ä¸¤ä½æ•°å­—ï¼ˆæ”¾å®½é™åˆ¶ï¼‰
					if (parts.length === 2) {
						const secondPart = parseInt(parts[1]);
						// åªæœ‰å½“ç¬¬äºŒéƒ¨åˆ†è¶…è¿‡åˆç†èŒƒå›´æ—¶æ‰è¿‡æ»¤
						if (secondPart > 999) {
							shouldFilter = true;
							formatted = formatted.replace(current.fullMatch, `<span class="filtered-version">${current.version}</span>`);
							continue;
						}
					}
				}
				
				// å¦‚æœæ˜¯ç»è¿‡å¤„ç†çš„ç‰ˆæœ¬å·ï¼Œæ›¿æ¢åŸæ–‡æœ¬ä¸­çš„ç‰ˆæœ¬å·
				if (finalVersion !== current.version) {
					formatted = formatted.replace(current.fullMatch, finalVersion);
					current.version = finalVersion;
					current.fullMatch = finalVersion;
				}
				
				// é¿å…é‡å¤æ·»åŠ ç›¸åŒçš„ç‰ˆæœ¬å·
				if (!processedVersions.has(finalVersion) && !shouldFilter) {
					processedVersions.add(finalVersion);
					versions.push({
						version: finalVersion,
						index: current.index,
						elementId: `version-${finalVersion.replace(/\./g, '-')}`,
						originalVersion: current.version !== finalVersion ? current.version : null
					});
				}
			}
			
			// ä¸ºç‰ˆæœ¬å·æ·»åŠ é“¾æ¥å’ŒIDï¼ˆåªç»™é€šè¿‡è¿‡æ»¤çš„ç‰ˆæœ¬å·æ·»åŠ é“¾æ¥ï¼‰
			const finalVersionRegex = /\b(\d+(?:\.\d+)+)\b/g;
			formatted = formatted.replace(finalVersionRegex, (match, version) => {
				const versionInfo = versions.find(v => v.version === version);
				if (versionInfo) {
					return `<span class="version-link" id="${versionInfo.elementId}" data-version="${version}">${version}</span>`;
				}
				return match;
			});
			
			// ä¸ºæ—¥æœŸæ·»åŠ æ ·å¼
			formatted = formatted.replace(/(\d{4}å¹´\d{1,2}æœˆ\d{1,2}æ—¥|\d{4}-\d{2}-\d{2})/g, 
				'<span style="color: #27ae60;">$1</span>');
			
			return { formattedContent: formatted, versions: versions };
		}

		// ä¸ºç‰ˆæœ¬å·é“¾æ¥æ·»åŠ ç‚¹å‡»äº‹ä»¶
		function addVersionClickEvents() {
			const versionLinks = document.querySelectorAll('.version-link');
			versionLinks.forEach(link => {
				link.addEventListener('click', function(e) {
					e.preventDefault();
					const version = this.getAttribute('data-version');
					showVersionOverlay(version);
				});
			});
		}

		// æ˜¾ç¤ºç‰ˆæœ¬å·é€‰æ‹©é®ç½© - å·²ä¿®å¤æ˜¾ç¤ºé—®é¢˜
		function showVersionOverlay(highlightVersion = null) {
			const overlay = document.getElementById('versionOverlay');
			const grid = document.getElementById('versionGrid');
			const header = document.getElementById('overlayHeader');
			
			// é‡ç½®æ»šåŠ¨çŠ¶æ€
			resetScrollState();
			
			// æ¸…ç©ºç°æœ‰å†…å®¹
			grid.innerHTML = '';
			
			// åˆ›å»ºç‰ˆæœ¬å·ç½‘æ ¼
			versionData.forEach((versionInfo, index) => {
				const versionItem = document.createElement('div');
				versionItem.className = 'version-item';
				if (versionInfo.version === highlightVersion) {
					versionItem.classList.add('highlighted-version');
				}
				versionItem.textContent = versionInfo.version;
				versionItem.setAttribute('data-version', versionInfo.version);
				
				versionItem.addEventListener('click', function() {
					jumpToVersion(versionInfo.version);
				});
				
				grid.appendChild(versionItem);
			});
			
			// æ˜¾ç¤ºé®ç½©
			overlay.classList.add('active');
			document.body.style.overflow = 'hidden';
			
			// å¯ç”¨æ»šåŠ¨éšè—åŠŸèƒ½
			enableScrollHide();
		}

		// é‡ç½®æ»šåŠ¨çŠ¶æ€
		function resetScrollState() {
			const header = document.getElementById('overlayHeader');
			header.classList.remove('hidden');
			lastScrollTop = 0;
			scrollHideEnabled = true;
			if (headerHideTimer) {
				clearTimeout(headerHideTimer);
				headerHideTimer = null;
			}
		}

		// å¯ç”¨æ»šåŠ¨éšè—åŠŸèƒ½
		function enableScrollHide() {
			const overlay = document.getElementById('versionOverlay');
			const header = document.getElementById('overlayHeader');
			
			// ç§»é™¤ä¹‹å‰çš„äº‹ä»¶ç›‘å¬å™¨
			overlay.removeEventListener('scroll', handleOverlayScroll);
			
			// æ·»åŠ æ–°çš„äº‹ä»¶ç›‘å¬å™¨
			overlay.addEventListener('scroll', handleOverlayScroll);
		}

		// å¤„ç†é®ç½©æ»šåŠ¨äº‹ä»¶
		function handleOverlayScroll(e) {
			if (!scrollHideEnabled) return;
			
			const header = document.getElementById('overlayHeader');
			const currentScrollTop = e.target.scrollTop;
			
			// æ¸…é™¤ä¹‹å‰çš„å®šæ—¶å™¨
			if (headerHideTimer) {
				clearTimeout(headerHideTimer);
				headerHideTimer = null;
			}
			
			// åˆ¤æ–­æ»šåŠ¨æ–¹å‘å’Œè·ç¦»
			const scrollDiff = Math.abs(currentScrollTop - lastScrollTop);
			
			if (scrollDiff < scrollThreshold) {
				return; // æ»šåŠ¨è·ç¦»å¤ªå°ï¼Œä¸è§¦å‘
			}
			
			if (currentScrollTop > lastScrollTop && currentScrollTop > 50) {
				// å‘ä¸‹æ»šåŠ¨ä¸”è¶…è¿‡50pxï¼Œéšè—å¤´éƒ¨
				header.classList.add('hidden');
			} else if (currentScrollTop < lastScrollTop || currentScrollTop <= 50) {
				// å‘ä¸Šæ»šåŠ¨æˆ–å›åˆ°é¡¶éƒ¨é™„è¿‘ï¼Œæ˜¾ç¤ºå¤´éƒ¨
				header.classList.remove('hidden');
			}
			
			// è®°å½•å½“å‰æ»šåŠ¨ä½ç½®
			lastScrollTop = currentScrollTop;
			
			// è®¾ç½®å®šæ—¶å™¨ï¼Œåœæ­¢æ»šåŠ¨åçŸ­æš‚å»¶è¿Ÿå†å…è®¸ä¸‹æ¬¡éšè—
			headerHideTimer = setTimeout(() => {
				headerHideTimer = null;
			}, 150);
		}

		// è·³è½¬åˆ°æŒ‡å®šç‰ˆæœ¬
		function jumpToVersion(version) {
			const elementId = `version-${version.replace(/\./g, '-')}`;
			const targetElement = document.getElementById(elementId);
			
			if (targetElement) {
				// å…³é—­é®ç½©
				closeVersionOverlay();
				
				// æ»šåŠ¨åˆ°ç›®æ ‡å…ƒç´ 
				setTimeout(() => {
					targetElement.scrollIntoView({ 
						behavior: 'smooth', 
						block: 'center' 
					});
					
					// é«˜äº®ç›®æ ‡å…ƒç´ 
					targetElement.style.background = '#fff3cd';
					targetElement.style.transition = 'background 0.3s ease';
					
					setTimeout(() => {
						targetElement.style.background = '';
					}, 2000);
				}, 300);
			}
		}

		// å…³é—­ç‰ˆæœ¬å·é€‰æ‹©é®ç½©
		function closeVersionOverlay() {
			const overlay = document.getElementById('versionOverlay');
			const header = document.getElementById('overlayHeader');
			
			// ç¦ç”¨æ»šåŠ¨éšè—åŠŸèƒ½
			disableScrollHide();
			
			// é‡ç½®çŠ¶æ€
			resetScrollState();
			
			// å…³é—­é®ç½©
			overlay.classList.remove('active');
			document.body.style.overflow = '';
		}

		// ç¦ç”¨æ»šåŠ¨éšè—åŠŸèƒ½
		function disableScrollHide() {
			const overlay = document.getElementById('versionOverlay');
			overlay.removeEventListener('scroll', handleOverlayScroll);
		}

		// æ˜¾ç¤ºé”™è¯¯ä¿¡æ¯
		function showError(message) {
			const contentDiv = document.getElementById('content');
			contentDiv.innerHTML = `
				<div class="error">
					<h3>ğŸ˜” åŠ è½½å¤±è´¥</h3>
					<p>æ— æ³•åŠ è½½æ›´æ–°æ—¥å¿—æ–‡ä»¶</p>
					<p><small>é”™è¯¯ä¿¡æ¯: ${message}</small></p>
					<button class="retry-btn" onclick="loadUpdateLog()">é‡æ–°å°è¯•</button>
				</div>
			`;
		}

		// ç‚¹å‡»é®ç½©èƒŒæ™¯å…³é—­
		document.addEventListener('click', function(e) {
			const overlay = document.getElementById('versionOverlay');
			if (e.target === overlay) {
				closeVersionOverlay();
			}
		});

		// ESCé”®å…³é—­é®ç½©
		document.addEventListener('keydown', function(e) {
			if (e.key === 'Escape') {
				closeVersionOverlay();
			}
		});

		// é¡µé¢åŠ è½½å®Œæˆåæ‰§è¡Œ
		document.addEventListener('DOMContentLoaded', function() {
			// é¦–å…ˆåŠ è½½å¯¼èˆªæ 
			loadNavigation();
			
			// ç„¶ååŠ è½½æ›´æ–°æ—¥å¿—
			loadUpdateLog();
			
			// å»¶è¿Ÿæ£€æŸ¥ç¼“å­˜è¿‡æœŸ
			setTimeout(checkAndRefreshIfExpired, 300);
		});
	</script>
</body>
</html>